<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">    <!-- Bootstrap core CSS -->
	<meta name="keywords" content=" &quot;texer cube grid&quot; correction, avs, advanced visualization studio, wvs, winamp visualization studio" />
	<meta name="description" content=" &quot;texer cube grid&quot; correction AVS Troubleshooting" />
	
	<title> &quot;texer cube grid&quot; correction - Winamp Forums</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<div class="container">
<ol class="breadcrumb">
  <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>
  <li><a href="f-85.html">AVS</a></li>
  <li><a href="f-139.html">AVS Troubleshooting</a></li>
  <li class="active"> &quot;texer cube grid&quot; correction</li>
</ol>
<!-- div class="pda"><a href="t-204057.html?login=1" rel="nofollow">Log in</a></div -->
<p class="lead text-muted">Archive: <a title="Try the Wayback Machine" target="_blank" href="http://web.archive.org/web/*/http://forums.winamp.com/showthread.php?t=204057">&quot;texer cube grid&quot; correction</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">6th January 2005, 12:27</div></div>
<br />
<div class="posttext">i've been working on some 3D-scope and texer II's during the last weeks and developed my own rotation matrix (guess it looks like every other matrix, but i think its important for understanding to make your own).<br />
<br />
However, i managed to code this cute texerII cube, but there are two problems i can't find a proper solution for.<br />
<br />
1.) i have the feeling that the cube gets contorted cause of the rotation. so where in the code should i care for the aspect ratio correction, at the end (3D/2D conversion) or on the rotaion matrices?<br />
<br />
2.) the second problem is about the size of the balls respectively the size of the gaps between them. how do i mange this size to stay (roughly) the same while the cube moves further away or comes closer?<br />
<br />
i hope those question are not too stupid or simple...<br />
<br />
Well, this is what i've done so far:</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">Jaak</div><div class="date small text-muted">6th January 2005, 12:48</div></div>
<br />
<div class="posttext">1) in the end do y = y * (w/h)<br />
2) i dont quite understand what you mean, but i guess you could change... just use distance between camera and object<br />
you have to move object before rotation, not after it</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">6th January 2005, 14:00</div></div>
<br />
<div class="posttext">thanks for the help<br />
<br />
1) but as i presumed y=y*(w/h) does not really work, it looks even a bit more contorted in some positions...<br />
<br />
2) my intention was to change the ball-size depending on the z-position. In real life an object gets smaller when its further away. i wanted that the balls grow/shrink correctly when moving towards/away from the screen. Any idea?<br />
<br />
What do you mean with camera? (never thought about that) it should be fix point, isn't it? What are my camrea coordinates then?<br />
<br />
btw what are the benefits if i shift the cube at first and rotate it afterwards? When i learned &quot;affine mapping&quot; (hope its the correct translation..) in school the formula was like:<br />
<br />
a:x = A+x + c (http://img134.exs.cx/img134/126/affinemapping1tw.jpg ) (with A: matrix, and c: movement vector)<br />
<br />
so why is it better the other way round here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">jheriko</div><div class="date small text-muted">6th January 2005, 17:58</div></div>
<br />
<div class="posttext">x=x*h/w; and size=(h*.003)/(1+z5/2);<br />
<br />
fixes it nicely imo<br />
<br />
the size needs to be transformed by the same method as the coordinates to be consistent with them. introducing w/h makes it res independant since the size of the particles is based on the screen height and some aspect ratio correction is applied.<br />
<br />
when working with superscopes like this there isn't really a camera whose co-ordinates you know. essentially you are at 0,0,0 looking down the z-axis at a world that moves around you the 2+z or whatever in the projection shifts the whole world by 2 units so that you have the impression of looking at the 'origin'. By doing the rotation first you are rotating the world then shifting its position. The 'camera cordinates' could be got back by rotating the 0,0,-2 vector backwards I suppose... but thats expensive.<br />
<br />
When using 'camera code' the idea is to take this method and expand on it a bit. Basically you take the camera coords ox,oy,oz and shift the whole world by them, like x1=x1-ox;y1=y1-oy;z1=z1-oz; then you rotate by the angles you want *the camera* to rotate by, remember that to start with it is looking down the +ve z axis (assuming you are clipping the negative values... otherwise you get ugly line bugs). In essence you are shifting the world and rotating it around the 'camera' to achieve the effect. When doing the final xyz-&gt;xy transform you no longer need to shift the z axis since we have already set up a fake camera to setup our viewpoint. all we need to do is x=x1/z1;y=y/z1; or even better (faster) z1=1/z1;x=x1*z1;y=y1*z1; using a camera like this you can move to any point in the world and look in any direction without having to do much head scratching. The problem comes when you want to use 'look at' code, which can often cause gimbal lock if used badly. There are advantages and disadvantages to either method, the main advantage of using a camera is that you can synchronise lots of different types of 3d things together easily.</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">Jaak</div><div class="date small text-muted">6th January 2005, 18:05</div></div>
<br />
<div class="posttext">your rotation seems fine to me, i think some ppl call that &quot;distortion&quot; perspective<br />
<br />
if you use tiny bit of logic, then you could relize that what greater the distance is, the smaller the object you look is. So, you have to use distance from object to camera to set the size of each particle. Just use the z value<br />
<br />
meh, if you want to move the oject in 3D space, then you have to do it before rotation, if you do it after rotation, you just move the picture to left/right or size it (z value). Really depends on what you want to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">jheriko</div><div class="date small text-muted">6th January 2005, 18:50</div></div>
<br />
<div class="posttext">got bored and mixed this up to make a cool volumetric thingy...</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">hboy</div><div class="date small text-muted">6th January 2005, 19:15</div></div>
<br />
<div class="posttext">werent you from england jheriko? speaking german eh? goddamn sexy cube man. awesome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">6th January 2005, 22:24</div></div>
<br />
<div class="posttext">don't wonder about the german comments. i added them when i made the texerII cube which jheriko fixed up a tiny bit ;). I just commented so much on this, so that i can handle the 3D-rotation code better. (which actully is one of my first attempts in this topic).<br />
<br />
But maybe if some tutorials/explantions were also available in german i would learn much faster, cause i have to translate everything first, before i can go on and try to understand it...<br />
<br />
but. WOW! that's amazingly cool what you've mixed up there... really like that!!<br />
<br />
but unfortunately i don't understand some of your additions.<br />
<br />
So you optimized the shifting with the &quot;sin&quot;s, ok get that. also you fixed the 3D/2D translation and the aspect ratio correction, get that too. got the &quot;res independant sizing&quot; either.<br />
<br />
But what's the technique behind the metablobs, is it that ominous raytracing-thing? (where can i learn more about that? 3d rotation-help lies around everywhere)<br />
Guess the &quot;volumetric effect&quot;  has to do with the color-code and therefore has to do with the blobs, but how does it work together? :confused:<br />
<br />
So much open questions, hope you can explain some more? would really like to learn more.<br />
but please step by step :)<br />
<br />
<br />
oh, and jaak, i've tried to use only the z-value for the size change but it looked a bit crappy, so i asked if someone knows some tips and tricks for this.<br />
<br />
<br />
o.k now i have to re-read jheriko's explanation post. hope that i get it soon... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">Jaak</div><div class="date small text-muted">7th January 2005, 00:16</div></div>
<br />
<div class="posttext">Originally posted by ^..^  <br />
but unfortunately i don't understand some of your additions.<br />
<br />
So you optimized the shifting with the &quot;sin&quot;s, ok get that. also you fixed the 3D/2D translation and the aspect ratio correction, get that too. got the &quot;res independant sizing&quot; either.<br />
<br />
But what's the technique behind the metablobs, is it that ominous raytracing-thing? (where can i learn more about that? 3d rotation-help lies around everywhere)<br />
Guess the &quot;volumetric effect&quot;  has to do with the color-code and therefore has to do with the blobs, but how does it work together? :confused:<br />
<br />
<br />
check the d,d1,d2,etc. part, it has simple distance calculation innit, when using it in colour code it is quite easy to get cool looking metablobs in the texer-cube.<br />
<br />
In similar way, metablob dms are done aswell</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">7th January 2005, 00:30</div></div>
<br />
<div class="posttext">do you know what maths is behind it? Mostly i try to understand things in AVS using my math-skills.<br />
So i did with the 3D rotation thing i learned recently. I took three roation matrices, one doing a rotation around the x-axis, one around y and one around z. then i worked out the matrices and got the lines of code for avs.<br />
<br />
But what bases the metablobs-code on? It's just to better comprehend it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">PAK-9</div><div class="date small text-muted">7th January 2005, 01:11</div></div>
<br />
<div class="posttext">Heh thats a wicked mix J. Its actually a bit of a laugh playing with the texer2..</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">hboy</div><div class="date small text-muted">7th January 2005, 08:26</div></div>
<br />
<div class="posttext">you codemonkeys feel sooo comfortable now do you :D awesome presets!...errmm...techdemopresets!</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">7th January 2005, 10:13</div></div>
<br />
<div class="posttext">thanks guys... i tried to do something demanding but what happens when i reach my objective? some super-heavy coding experts come along and blow this cube up to something totally incomprehensible. very good job... :hang: <br />
<br />
<br />
joking apart... cool what can be done with such a basis-scope. somehow paks cube reminds me of some quantum machanics... great work too...</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">PJ-Avser</div><div class="date small text-muted">7th January 2005, 10:15</div></div>
<br />
<div class="posttext">Jheriko's mix looks almost exactly like my preset cubation, Except it is mostly blue and pulses. I'm annoyed cause that took ( me ) ages to do and now it's not original. OH well. * goes and changes colour code* ooooh, now it's 3D plasma! I'm not showing you It though, you'll have to download my pack! ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">7th January 2005, 10:56</div></div>
<br />
<div class="posttext">yeah, that's the way it goes! You think you made something special or tried to do something complicated, but as soon as you finish, one of those codemonkeys (nice word hboy ;) ) comes up with something much better... :( bad luck...<br />
<br />
well, mostly you can learn something from the codemonkeys, so it's not that bad, at all. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">Jaak</div><div class="date small text-muted">8th January 2005, 11:42</div></div>
<br />
<div class="posttext">Math behind it? Its just plain stupid distance calculation,<br />
distance between point (x1,y1,z1) and (x2,y2,z2) can be calculated with:<br />
D = ((x2-x1)^2+(y2-y1)^2+(z2-z1)^2)^(1/2);<br />
or: sqrt(sqr(x2-x1)+sqr(y2-y1)+sqr(z2-z1))<br />
and dont say you havent learned it in school yet?</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">8th January 2005, 14:01</div></div>
<br />
<div class="posttext">yeah, thats clear! thank you for your patience :D<br />
somehow i didn't recognize it...<br />
<br />
So the aditional code generates a d-value (polar coords) for each of the four metablobs, which means generating a radius, right? and cause the &quot;px,py,pz&quot; values generated in Frame vary -(time dependent, not framerate dependent)- d1/d2/d3/d4 varies too. in the end it looks as if the blobs move around. but how did he generate the blobs in the color-code only working with d=d1+d2+d3+d4 as variable? that seems illogical  to me somehow, cause the four blobs move around freely. They should depend on either d1, d2, d3 OR d4 and not on d1, d2, d3 AND d4 (at least in my imagination).<br />
i hope i haven't infected you with my confusion and you can still explain that second part?</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">jheriko</div><div class="date small text-muted">9th January 2005, 08:01</div></div>
<br />
<div class="posttext">there are a lot of ways of doing metablobs. the way i did it makes a finite number of blobs and maintains areas/volumes so that as two blobs merge no 'matter' is created or destroyed, this tends to look best as it simulates the 'real world' a bit better... but its just a matter of taste.<br />
<br />
lets start with defining circles and try to work it towards metablobs. Lets say that we do this by finding points that are a set distance away from the circle's centre. we would need something like (over simple): <br />
<br />
d1=sqrt(sqr(x-px1)+sqr(y-py1));<br />
d2=sqrt(sqr(x-px2)+sqr(y-py2));<br />
d3=...<br />
d=bor(below(d1,.1),below(d2,.1))+bor(below...<br />
<br />
where px1,py1 px2,py2 etc... are the centres of the blobs, and we draw whereever d=1<br />
<br />
the problem with this is that no blobbing happens. we need to take into account the distances to all of the centrepoints when working out if we draw a point or not since if two blobs are near then our point may be in neither circle but could be in the blobby mass that joins them. for this reason we need to combine d1 d2 etc to create the  metablob effect.<br />
<br />
because the distance gets smaller nearer the centre its not the best way to define the boundaries of the system of blobs since we are interested in how close we are to the centres to work out the blobbing, not how far away they are. what might be better is to use 1/d1 1/d2 etc since they are higher at the centre. so we do:<br />
<br />
d1=1/sqrt(sqr(x-px1)+sqr(y-py1));<br />
d2=1/sqrt(sqr(x-px2)+sqr(y-py2));<br />
d3=...<br />
d=above(d1+d2+d3...,10);<br />
<br />
this creates a metablob effect, its not perfect though.<br />
<br />
in a simple system with d1 d2 based on p1x/y p2x/y and d=d1+d2 we can se that if we use above(d1+d2,10) then when p1 and p2 meet the blob doesn't increase in size correctly since for a single blob d1 (or d2) = 10 if the distance to p1 (or p2) is equal to .1 since 1/.1 = 10, but for the two blobs together on the same spot 2/.2 = 10, but our radius has doubled! which means that our area has grown by 4 instead of 2! to fix this we do:<br />
<br />
d1=1/(sqr(x-px1)+sqr(y-py1));<br />
d2=1/(sqr(x-px2)+sqr(y-py2));<br />
d3=...<br />
d=above(d1+d2+d3...,100);<br />
<br />
then 1/sqr(.1) = 100 and 2/sqr(sqrt(.2)) = 100 and we have the correct new radius of sqrt(.2) for a joined blob</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">9th January 2005, 12:06</div></div>
<br />
<div class="posttext">many thanks!!<br />
i won't understand everything straight off, but i'll proceed step by step...<br />
<br />
ok. let me repeat your explanation with my own words. Please correct me when i got something wrong.<br />
<br />
at first we have do set the distance of the blob's centers and their outer bounds and taking into consideration that the radius increases when two blobs approach each other.<br />
<br />
This way we want to achieve that the variable d tells us if the momentary point is affected by a blob or not.<br />
when we add d1+d2+d3+d4 we add all metablob influences. the resulting sum is the sum of meatblob influence.<br />
<br />
the result will be, that d is 0 for a point that is outside of any blob and will increase when a blob gets near. (nearer = greater value for d). Afterwards we can apply d in the color code, then it becomes visible whether a point is affected by a metablob or not.<br />
Please correct me if i understood anything wrong!<br />
<br />
but in case it's correct, could you please spent a few words about your color code itself? or how to apply the metablob value to other components in general? many thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">9th January 2005, 13:33</div></div>
<br />
<div class="posttext">i've just tried out a simple colorcode: color=(1/z4*0.5)*0.1*d together with your metablob code.. <br />
and the blobs got visible! so this is clear now. (would still be great to know a bit abour metablobs and other avs-components...<br />
<br />
btw now i'm wondering about the time-independant movement you made:<br />
<br />
t=t+gettime(lasttime);<br />
lasttime=gettime(0);<br />
<br />
why do you write gettime(lasttime)?<br />
&quot;lasttime&quot; gives you the time since last boot, right? but when set as gettime(lasttime) avs will reduce its value to 1 since the time since last boot is always a positive number. So what does your code do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">Jaak</div><div class="date small text-muted">10th January 2005, 05:46</div></div>
<br />
<div class="posttext">your metablob explanation sounded correct, tho' it isn't really that hard as you made to sound it.<br />
i am speculating that gettime(someothertime) will return time from the someothertime (currenttime - lasttime, i might be wrong tho', correct me if i am), so this is simply fps dependant movement, whatever the fps is, t gets incremented by correct ammount.</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">10th January 2005, 08:51</div></div>
<br />
<div class="posttext">yea, however it works it does what it is supposed to do, but<br />
t=gettime(0)<br />
works just as fine as<br />
t=t+gettime(lasttime); lasttime=gettime(0)<br />
so i was wondering why not use the first code?<br />
<br />
At least i now understand the metablob-effect in this grid-cube. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">UnConeD</div><div class="date small text-muted">10th January 2005, 22:39</div></div>
<br />
<div class="posttext">Jheriko's explanation that the function has to be &quot;higher at the centre&quot; is not specific enough. What matters for proper 'blobbing' to occur is that the fall-off function is convex (i.e. second derivative &gt; 0, shape goes like ***8899; ) and drops the further you go from the blob.<br />
<br />
The attached preset shows what happens when the falloff function is convex, neutral or concave (***8898; ). In the concave case, a bump forms in between, which causes a 'phantom' blob in between the metablobs before they merge.</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">^..^</div><div class="date small text-muted">11th January 2005, 00:34</div></div>
<br />
<div class="posttext">i see, but doesn't it HAVE to be that way? i mean the metablobs have to merge into each other in a convex way, because they ARE convex objects, don't they?<br />
<br />
to me it was obvious somehow from the beginning, i didn't even think about the whole convex,concave,linear thing... ;)<br />
But you're right, one could think of a different/wrong &quot;gradient&quot; when you read &quot;higher at the centre and lower at the boundaries&quot;.<br />
<br />
btw i'm playing around a bit with the technique and i wanted to know where it's best to combine the metablobs-value with? It also works with the color-code of ssc's and i tried to do some blending with the blobs (combined it with &quot;alpha&quot;).... just curious if there's anything tricky about it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username text-primary">jheriko</div><div class="date small text-muted">14th January 2005, 22:11</div></div>
<br />
<div class="posttext">i use gettime(lasttime) as a bad habit. normally i do dt = gettime(lasttime) and use that for stuff... i just don't think a lot about the routine things...<br />
<br />
the 'correct' way to do blobs is to sum the inverse squares of the distances like in my code... it maintains the volume/area of blobs making it look like no material is magically created or destroyed.<br />
<br />
working it out before you set red green blue or whatever is usually a good way to it. all you have to do is make sure that you work it out based on the right co-ordinates... so if you rotate a 3d scene you work out the sum before rotating the points.</div></div><hr />
<div class="footer">
	<p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
</div>
</div>

</body>
</html>