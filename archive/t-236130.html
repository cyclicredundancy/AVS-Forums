<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.12), see www.w3.org" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Testing Needed AVS" />

  <title>Testing Needed - AVS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-137.html">AVS Presets</a></li>

      <li class="active">Testing Needed</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236130">Testing Needed</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">22nd January 2006 07:20 GMT</span></p>

      <p class="post-content"><strong>Testing Needed</strong><br />
      This is a test for fps independancy, musical influence, and interactivity. For those who have seen my latest pack, reincarnation, this preset is a simpler version of Zenith.<br />
      <br />
      I've finally had some time to work on AVS, but decided that for my next pack, I'm going to lay down a basic guideline and structure that I can use at different times for the presets. However, since I wasn't sure where to start: Credits to Pak-9 and Tuggummi for some code and ideas which this code was modeled from. This will probably be changed many many times again before it becomes final (even though the preset name may be deceiving :p), but I felt it best to credit you guys for it anyway.<br />
      <br />
      The main reason I posted this is that I need some help, advice, critiques, et cetera. I'm only concerned with the very first scope, but I'm not really sure if this even works all that well or if I've done everything, or anything, correctly (even though I'm sure there is no "right" way). I guess I just want to make sure that it all works. I know the code for the sound data is ugly at best, but does it work sufficiently? Anyway so, if I can get some feedback I would be very grateful.<br />
      <br />
      Thanks in advance!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">Tuggummi</span><br />
      <span class="date small text-muted">22nd January 2006 13:37 GMT</span></p>

      <p class="post-content">Well the fps fix seems to be working like it should (which im glad you <b>finally</b> decided to add to your presets ;)), but im not sure what else kind of feedback you're looking for it. The control keys worked too.<br />
      <br />
      Well im not much of a technical assistant so i can't do anything beyond confirming that your preset works :p</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">JaVS_v2.5</span><br />
      <span class="date small text-muted">23rd January 2006 07:15 GMT</span></p>

      <p class="post-content">Everything works really fine. Nothing to say means nothing's wrong :p<br />
      <br />
      This preset is great and cool, it's respond to music very well..<br />
      <br />
      <font size="1">and yeah, I like it.. much..</font></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">jheriko</span><br />
      <span class="date small text-muted">23rd January 2006 20:03 GMT</span></p>

      <p class="post-content">x5=x4/(1+(2+z4)/2)*-1;<br />
      y5=y4/(1+(2+z4)/2)*-1;<br />
      <br />
      i dunno where to start on what is wrong with that :P<br />
      <br />
      here is how i would have done it:<br />
      <br />
      opt=-1/(2+.5*z4);<br />
      x5=x4*opt;<br />
      y5=y4*opt;<br />
      <br />
      <br />
      explaination why:<br />
      <br />
      (1+(2+z4)/2)*-1 is divided by twice. / is slow and * is faster, so much faster that doing one div and two muls is faster than two divs so<br />
      <br />
      opt = 1/(1+(2+z4)/2)*-1;<br />
      <br />
      x5=x4*opt;<br />
      y5=y4*opt;<br />
      <br />
      is the first step i took. i then simplified the opt line to remove the spurrious bits, again because / is slower than * i replace /2 with *.4, because *-1 is the same as placeing - at the beginning i did that.. i also expanded the redundant brackets in the statement to reduce it even further.<br />
      <br />
      opt = 1/(1+(2+z4)/2)*-1;<br />
      opt = -1/(1+(2+z4)/2);<br />
      opt = -1/(1+(2+z4)*.5);<br />
      opt = -1/(1+2*.5+z4*.5);<br />
      opt = -1/(1+1+z4*.5);<br />
      opt = -1/(2+z4*.5);<br />
      <br />
      this may seem long winded, but it took me hundreds of times longer to write out than to 'just do' in code... it gets easier and more automatic with practice.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">23rd January 2006 20:24 GMT</span></p>

      <p class="post-content">:p That's already been optimized, you're just seeing the outdated version of this preset.<br />
      <br />
      But again, that wasn't really my concern. I suppose I am mainly concerned with whether or not the fps fix and the music data is working as it should.<br />
      <br />
      Either way, thanks for the comment. :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">jheriko</span><br />
      <span class="date small text-muted">23rd January 2006 20:58 GMT</span></p>

      <p class="post-content">Well the fps independent code is broken too...<br />
      <br />
      beat=(beat+1)%40;<br />
      bf1=above(beat,10)*fps*0.5;<br />
      bf2=above(beat,20)*fps*0.8;<br />
      bf3=above(beat,30)*fps*0.5;<br />
      <br />
      doing it on beat is wrong<br />
      <br />
      fps isnt actually storing the framerate per second which confused me at first i must add too :P<br />
      <br />
      you need to do it every frame because the framerate fluctuates: e.g.<br />
      <br />
      frame:<br />
      time=gettime(0);dt=time-old;old=time;<br />
      rotate = rotate + rotatespeed*dt;</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">Tuggummi</span><br />
      <span class="date small text-muted">24th January 2006 07:45 GMT</span></p>

      <p class="post-content">Well if he used my code for inspiration, that would be my fault... I used to "fix" the framerate in Extra Dimension on-beat :hang:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">24th January 2006 17:48 GMT</span></p>

      <p class="post-content">:) That does seem to make a difference.<br />
      <br />
      I suppose the only other question I have now is why it speeds up gradually to start with, then when it peaks it drops off to move at about half the speed, then continues at normal. Does that have something to do with the beat code?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">jheriko</span><br />
      <span class="date small text-muted">24th January 2006 23:22 GMT</span></p>

      <p class="post-content">Basically stuff like this a=a*.99; also needs to be made time independent, you have done this somewhere in code:<br />
      <br />
      rxm=rxm+(rxe-rxm)*.01+up-down;<br />
      <br />
      and stuff like this too is prolly not fps independent either (*.01). instead of copying and guessing based on someone else code take a logical approach<br />
      <br />
      <br />
      The framerate/delta t between frames alters potentially every frame. this means that any line which does a 'fixed amount' of change to a variable per frame is going to need changing:<br />
      <br />
      where a,b,c,d are some constants and ka,kb,kc,kd are values which give similar results with framerate independent code:<br />
      <br />
      t=t+a; becomes t=t+dt*ka;<br />
      t=t-b; becomes t=t-dt*kb;<br />
      t=t*c; becomes t=t*pow(kc,dt);<br />
      t=t/d; becomes t=t*pow(kd,-dt);</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">27th January 2006 01:21 GMT</span></p>

      <p class="post-content">This makes sense, but where have I constants that need changing? If you referring to this:<br />
      <br />
      rxm=rxm+(rxe-rxm)*.01+up-down;<br />
      <br />
      I'll agree that multiplying by one hundredth isn't making the variable independant of the framerate, but the varible rxe is:<br />
      <br />
      rxe=(bf1+bf2)*fps+engine;<br />
      <br />
      So is this not enough then? Perhaps I may have misinterpreted your previous post, but it seems to do the trick.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">jheriko</span><br />
      <span class="date small text-muted">30th January 2006 02:43 GMT</span></p>

      <p class="post-content">maybe i didnt read the code enough :)<br />
      <br />
      i assumed that was targeting code for some reason, which it clearly isn't on further inspection. however, that whole block is still not fps independent...<br />
      <br />
      rxm=rxm+(rxe-rxm)*k<br />
      <br />
      rxe-rxm is confusing, personally I can't work out in my head if it breaks or not, but subtracting a time independant value from some constant (its constant this frame) doesn't seem like it should produce something time independent, it may change rxe time independently, but it is being altered then applied to make rxm change per frame:<br />
      <br />
      rxm=rxm+(rxe-rxm)*k*dt would be much better<br />
      <br />
      also you then go and add up and subtract down, which means you need to do this:<br />
      <br />
      rxm=rxm+(rxe-rxm)*k*dt +up*dt + down*dt<br />
      <br />
      basically when you have:<br />
      <br />
      time_dependant = time_dependant + some_stuff<br />
      <br />
      you want:<br />
      <br />
      time_dependant = time_dependant + f(some_stuff, delta_t)<br />
      <br />
      normally:<br />
      <br />
      time_dependant = time_dependant + k*some_stuff*delta_t<br />
      <br />
      <br />
      btw, if you want to make your code more readable, don't use fps as the variable name in that context. fps means frames per second in a lot of contexts, what you are measuring is the number of seconds elapsed per frame, i.e. "seconds per frame" which is usually referred to simply as the change in time, or in more maths/science/computing contexts "delta t(ime)"<br />
      <br />
      if you want the actual framerate in fps, do:<br />
      <br />
      fps = 1/delta_t<br />
      <br />
      <br />
      <br />
      EDIT: okay i worked out the rxe-rxm thing. It IS targeting, I just got confused trying to read and work it out:<br />
      <br />
      rxm = .9*rxm+.1*rxe;<br />
      <br />
      rxm -&gt; rxe over time<br />
      <br />
      the .9 and .1 need to change to match the time so that the targetting moves independently of framerate, e.g. for shorter frames you want to move less, for longer frames you want to move more. i think the correct way is like this:<br />
      <br />
      optimiser = pow(.9,30*dt);<br />
      rxm = optimiser*rxm + (1-optimiser)*rxe;<br />
      <br />
      this would give the same effect as using the current targetting at 30fps, except it adapts to the framerate changes.<br />
      <br />
      On a side note, this trick is useful for making a sort-of time independent fadout effect, do a color modifier like this:<br />
      <br />
      [code]<br />
      init:<br />
      t=gettime(0);<br />
      curve=.9;speed=60;<br />
      curve=max(0,min(curve,1));<br />
      <br />
      frame:<br />
      oldt=t;t=gettime(0);dt=t-oldt;<br />
      opt=pow(curve,speed*dt);<br />
      <br />
      level:<br />
      red=red*opt;<br />
      blue=blue*opt;<br />
      green=green*opt;<br />
      [code]<br />
      <br />
      curve and speed control the speed and the 'brightness curve' used for the fadeout.<br />
      <br />
      there are still differences at different framerates, but the overall brightness should remain roughly the same, eliminating the classic 'white preset' problems.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">30th January 2006 03:29 GMT</span></p>

      <p class="post-content">Slow down! :p<br />
      <br />
      Really though, you've lost me. It took me two days to understand everything you were saying in your previous post. Now I honestly have no idea what's going on. Where did k come from? What are dt and f?! I don't mean to, so to speak, bite the hand that feeds, but it's just not making sense.<br />
      <br />
      For better or for worse, for the time being, I'm going to hold off on this stuff until I can get a better grasp on it. I think I'm just going to use what I know technically, but combine it with my style and use of trans effects.<br />
      <br />
      I'm hoping that you're not upset, and that you don't see all the help you've given as have been done in vain. On the contrary, I'm very grateful for it! It's been enligtening, and certainly educational. But unfortunately, as I told Pak, I see myself as more of an artist than a programmer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">jheriko</span><br />
      <span class="date small text-muted">1st February 2006 05:19 GMT</span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by denkensiefursich</i><br />
        <b>Where did k come from? What are dt and f?! I don't mean to, so to speak, bite...</b>
      </blockquote>k is any constant, i used it to remove the discrepencies in several lines from changing them from non-fps to fps independent. e.g. if we make a=a+da; into a=a+da*dt; we need to modify the original da to get a visually similar result: a=a+k*da*dt; then by some little axioms it follows that for any system changing by adding or subtracting a linear combination of constants, e.g.<br />
      <br />
      f(x+1)=f(x)+a0+a1+a2...+an etc<br />
      then<br />
      f(x+1) = f(x) +(a0+a1+a2...+an)*dt*k<br />
      <br />
      dt, as i pointed out, is delta-time, the change in time. what you called 'fps' in your code.<br />
      <br />
      f is the generic symbol used for a function, e.g.<br />
      <br />
      f(x,y) = a*x+b*y+c^x+sqrt(y) etc...<br />
      <br />
      <br />
      <br />
      Its not that hard to make a preset time independent. Its just better to design it that way first, with a proper understanding (which I assume is automatic :p) of how the effects of changing a variable may be dependent on the framerate. I think I probably confused you by complaining about how confusing I found your code. :)<br />
      <br />
      Also the first bit about rxe-rxm can be ignored... i left it in so the edit wasn't out of context...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">5th March 2006 06:20 GMT</span></p>

      <p class="post-content">Sorry to drag this back up, but I've finally found some time to dig through everything and apply what I had learned to this preset.<br />
      <br />
      Jheriko, let me know if I've got a better handle on things now, or if I'm still missing something. The only thing I still don't know what to do with is the beat section. Right now, the camera seems to follow a set path, never veering from it. Is there someway to change this without it becoming too erratic?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">5th March 2006 06:22 GMT</span></p>

      <p class="post-content">Shit, forgot the zip. :p</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">hornet777</span><br />
      <span class="date small text-muted">5th March 2006 20:30 GMT</span></p>

      <p class="post-content">would be better to choose filenames with legal characters</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">6th March 2006 00:15 GMT</span></p>

      <p class="post-content">:rolleyes: The filename is not the concern. However, if you insist...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">The Earthquaker</span><br />
      <span class="date small text-muted">26th March 2006 14:10 GMT</span></p>

      <p class="post-content"><strong>Testing successful</strong><br />
      The original preset's interactivity and music vis' quality were great! It worked well (in average fps only, because of pos/fps speed dependancy that was described by Jheriko, i admit that i didn't look at the cause, never, i just believe it's fixed). The final preset was much worse, because of lost interactivity. i just look forward for the preset where fps independancy and interactivity come together.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="username text-primary">eheiney</span><br />
      <span class="date small text-muted">27th March 2006 07:10 GMT</span></p>

      <p class="post-content">Well if I understood Jheriko correctly, the preset now looks as if it runs at 30fps. As he said, it "give[s] the same effect as using the current targetting at 30fps, except it adapts to the framerate changes." If you change the variable "optimizer", I would assume that you can run the preset any fps you prefer. I still don't fully understand it, but the logic would seem to agree.<br />
      <br />
      As for the interactivity, it was just a bit of a test. I personally don't find much use for it, I just wanted to know if I could do it and make sure it worked, just in case a use came up later on in my career.<br />
      <br />
      Anyway, thanks for the comment. :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
    </div>
  </div><!-- Put JavaScript here -->
</body>
</html>
