<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="APE Coding, How does the Framebuffer Work???"><title>APE Coding, How does the Framebuffer Work??? - AVS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-7','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"></noscript> <script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body style="display:none"><div class="container"><div class="row"><div class="dropdown pull-right"><button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">Change style <span class="caret"></span></button><ul id="css-select" class="dropdown-menu" role="menu"><li><a href="#" rel="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">Default</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Bootswatch</li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/amelia/bootstrap.min.css">Amelia</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css">Cerulean</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css">Cosmo</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cyborg/bootstrap.min.css">Cyborg</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css">Flatly</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css">Journal</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css">Readable</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css">Simplex</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/slate/bootstrap.min.css">Slate</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css">Spacelab</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css">United</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css">Yeti</a></li></ul></div></div><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-85.html">AVS</a></li><li class="active">APE Coding, How does the Framebuffer Work???</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264850">APE Coding, How does the Framebuffer Work???</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Chaos_2k</span><br></p><p class="post-time small text-muted">1st February 2007 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"><strong>APE Coding, How does the Framebuffer Work???</strong><br>Hi<br><br>Im writing AVS Presets since im 11years and after beeing into trigonometry and advanced mathematics and learning c++, i Want to start writing APEs.<br><br>But i simply cant figure out how the framebuffer works.<br>Somewhere on these forums i read this:<br><br>the *int framebuffer pointer points to the first pixel of the framebuffer, in which colour information is stored in 00RGB format (whatever this means)<br><br>From the BOX Tutorial<br>Example:<br></p><blockquote>int C_THISCLASS::render(char visdata[2][2][576], int isBeat, int *framebuffer, int *fbout, int w, int h)</blockquote>If i understood the usage of pointers u would acces the ADRESS of *int framebuffer via<br>ADRESSFB=framebuffer<br>And the Data (i think its colour information) via int COLPIXEL=*framebuffer<br><br>is this right?<br><br>so what does this:<br><br><blockquote>framebuffer+=(((halfh/2)*w)+ (halfw/2));</blockquote>I think this is pointer arithmetics, but it simply makes no sense to me, i cant understand it.<br><br><blockquote>for(int j=0;j&lt;halfh;j++) { for(int i=0;i&lt;halfw;i++) { framebuffer[i]=color; } framebuffer+=w; }</blockquote>What i guess happens here is that the pixels in the fb are processed and there colour is changed.<br><br>Plz help me understanding</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Chaos_2k</span><br></p><p class="post-time small text-muted">1st February 2007 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">It would help me too if someone could tell me if its possible to debug my APE with VS2002 with the DLL Debugger, simply cant get it to work.<br><br>thx Chaos_2k</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Chaos_2k</span><br></p><p class="post-time small text-muted">2nd February 2007 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">anyone???<br>im desperate :cry:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p><p class="post-time small text-muted">5th February 2007 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">quite frankly, if you are struggling with the concept of a framebuffer you really shouldnt be trying to code an APE.<br><br>I would normally post something more helpful but if your understanding is that limited I'm not sure where to start. Try reading some c++ tutorials (pointers and arrays in particular), then try looking up some basic graphics programming theory (framebuffers and pixel formats in particular)<br><br>P.S. I personally have not got debugging of avs to work in VS.NET (bear in mind that it is a vc6 project and you do lose some stuff in the conversion) but apparently it is possible.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Chaos_2k</span><br></p><p class="post-time small text-muted">5th February 2007 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">mh, yeah after some redaing about Bitmaps i got the point.<br>I simply didnt konw where to start. Its nowhere stated that the framebuffer is organized like a bitmap.<br>I havent had any experiences with framebuffers though ive already written little OpenGL aps.<br>You shouldnt forget im just 15 and still learning *g*<br><br>Im not that much skilled in c++ but i've already written some little games and stuff for parsing texts (wouldnt have to be in c++ nescesarely but i just wanted to try).<br><br>After i spend some days relaxing and doing sth. else, i tried to find out myself how it works. But whats not documented:<br>A Bitmap according to Microsofts Specs is starting with the first pixel on the bottom left.<br>The AVS framebuffer starts with the top left Pixel. Also AVS can only use resolutions that are quadruples of 4 because it cant fill up 4 bytes with zeros so the ampount of bytes per line are divisible by four.<br>Or has this a different reason? (i.e 32Bit what used by default will always give you a quadruple of 4, so why couldnt you use different resolutions?)<br><br>some questions to the c++ code: and YES ive tried to find out myself and this is what i came up with, i just want to know if its correct. I know some questions are realy basic and i think i understood pointers &amp; references. This is no hep forum for c++, but i think its quiet easy for you to answer as my questions arent that difficult.<br><br>Ill give some code to explain.<br><br></p><blockquote>//f recieves the pointer int pointer framebuffer which<br>//stores the Adress of the first (top/left) pixel<br>void f (*int framebuffer)<br>{<br>std.cout&lt;&lt;framebuffer&lt;&lt;endl; //this would print the adress<br>std.cout&lt;&lt;*framebuffer&lt;&lt;endl; //this would print the data stored @ the adress<br><br>framebuffer= framebuffer + w //this changes the adress by one "line"<br></blockquote>This would require the framebuffer to be stored in one sequence in memory, otherwise the result of this operation would be undefined and dangerous.<br><br>Next question. if the width of my avs window is 322, is w given to the render function 332, or something else? Because if you want to advance to the next pixel, you would have to go 32Bits ahead.<br>On a 32Bit system every Adress in the memory stores 32Bit of Data, so simply going on to the next adress means that there is the next pixel in the framebuffer, right?<br><br><blockquote>*framebuffer=color; //this changes the color of the current pixel</blockquote>right?<br><br><blockquote>for(int j=0;j&lt;halfh;j++) {<br>for(int i=0;i&lt;halfw;i++) {<br>framebuffer[i]=color; } framebuffer+=w; }</blockquote>The framebuffer[i]=color operation has nothing to do woth an array, right? Because the framebuffer is no array, its a sequence of 32bit Pixels stored in sequence in mem.<br><br>so whats the []operator???<br>The STL knows the bitset::operator[] but i dont think its waht this operator does.<br><br>Could one of you be so kind and correct me?<br><br>Sorry for my bad english and my inconvenience</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p><p class="post-time small text-muted">5th February 2007 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"></p><blockquote><i>Originally posted by Chaos_2k</i><br><b>mh, yeah after some redaing about Bitmaps i got the point.<br>I simply didnt konw where to start. Its nowhere stated that the framebuffer is organized like a bitmap.</b></blockquote>A framebuffer isn't like a bitmap, a bitmap is like a framebuffer. Although the comparison is valid.<br><br><blockquote><i>Originally posted by Chaos_2k</i><br><b>A Bitmap according to Microsofts Specs is starting with the first pixel on the bottom left.<br>The AVS framebuffer starts with the top left Pixel. Also AVS can only use resolutions that are quadruples of 4 because it cant fill up 4 bytes with zeros so the ampount of bytes per line are divisible by four.Or has this a different reason? (i.e 32Bit what used by default will always give you a quadruple of 4, so why couldnt you use different resolutions?)</b></blockquote>Okay you are probably taking the bitmap comparison too far now. Bitmaps do indeed start from the bottom left, AVS from the top left, this is arbitrary and unimportant. Windows bitmaps are dword (double word, i.e 32bit, sometimes call quad byte) aligned per row, meaning if a row of pixels at whatever pixel format ends at a number of bytes indivisible by four, zeros will be added to make it up to a byte value which is. The reason for this is speed related, working with 32bits at a time is a lot quicker than other sizes due to the architecture of (average) computers (for example all of the main registers in your cpu are 32bit unless you have a 64bit system). AVS does not have quad byte alignment because the pixel format is already 32bit (as opposed to windows bitmaps which can have 1,4,8,24 bit iirc) so there is no need. (I am not sure what you meant by "resolutions that are quadruples of 4", only 16 is a quadruple of 4 and I'm pretty sure avs supports resolutions above that :p )<br>___<br><br>I'm not going to quote the rest of your post because again I'm not sure where to start. You need to look up and experiment with arrays and pointers. Your basic knowledge gap is that an array IS a continuous block of memory, and there are two ways of accessing data in an array<br><br>The pointer way...<br><pre>
<code><br>//declare an integer pointer<br>int *piIntPointer;<br>//point piIntPointer to the first item of the array<br>piIntPointer = piBigArrayOfInts; <br>//point piIntPointer to the next item of the array<br>++piIntPointer;<br>//set it to some value<br>*piIntPointer = 1;<br></code>
</pre><br>
      <br>
      The array index way...<br>
      <pre>
<code><br>//access the array index we want directly and set its value<br>piBigArrayOfInts[1] = 1;<br></code>
</pre><br>
      <br>
      Neither is better, they are just different, but you should understand how each works since other people may use either in their code (the AVS source is pretty pointer heavy).<br>
      <br>
      Again, try to learn at least some c++ before diving into a relatively difficult task like an avs ape. You can ask more questions if you like but try to keep the short and to the point, I'm not going to keep typing huge replies :D
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chaos_2k</span><br></p>

      <p class="post-time small text-muted">5th February 2007 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Thx for your answer, helped me a lot. :D<br>
      <br>
      You expressed exactly what i thought about Bitmaps, but you know my bad english *g*<br>
      Quadruple was meant as something dividable by 4 or something multiplied with 4. :D<br>
      <br>
      I didnt know about the pointer way to acces arrays.<br>
      Im not that unskilled in writing c++ apps but im lacking experience in programming as you already noticed *g*<br>
      <br>
      I've also tried to understand the avs Source, and i have to say im very impressed about the eel concept with VMs and stuff like that.<br>
      Its a very good lesson to read and try to understand the Sourc.<br>
      <br>
      My deepest respect to those guys who wrote AVS *g*<br>
      <br>
      Thx Pak-9</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p>

      <p class="post-time small text-muted">6th February 2007 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">reading and understanding the AVS source is quite a good learning experience as you say, however it is not that easy since the code is pretty messy.<br>
      <br>
      The best way to learn coding is to actually do it, the more practice you have the better you will get.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jheriko</span><br></p>

      <p class="post-time small text-muted">7th February 2007 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Chaos_2k</i><br>
        <b><br>
        My deepest respect to those guys who wrote AVS *g*<br></b>
      </blockquote>Mostly one guy incidentally. All of the impressive bits anyway...<br>
      <br>
      Curse my computer for not working whilst such an awesome thread existed in the forums. :(
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p>

      <p class="post-time small text-muted">7th February 2007 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">I was a bit curious why you didn't dive in :p</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">goebish</span><br></p>

      <p class="post-time small text-muted">9th February 2007 08:08 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by PAK-9</i><br>
        <b>P.S. I personally have not got debugging of avs to work in VS.NET (bear in mind that it is a vc6 project and you do lose some stuff in the conversion) but apparently it is possible.</b>
      </blockquote>I can debug my APEs (and AVS source code) in VS.NET (2003 and 2005) without problem. Just compile a debug version of your APE into your plugins/avs folder then set winamp.exe as executable name for debug. Put some breakpoint, click run into visual studio, Winamp will launch, then run avs from winamp and instanciate your new ape from it. Your breakpoints should work :)<br>
      <br>
      Hope this helps.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p>

      <p class="post-time small text-muted">9th February 2007 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Useful, thanks :up:</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
    </div>
  </div>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" defer></script>
  <script type="text/javascript" src="../js/jquery.cookie.min.js" defer></script>
  <script type="text/javascript" src="../js/scripts.js" defer></script></body></html>