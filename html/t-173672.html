<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Normal AVS Code -&gt; loop() code translator" />

  <title>Normal AVS Code -&gt; loop() code translator - AVS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <div class="row">
        <div class="dropdown pull-right">
          <button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            Change style
            <span class="caret"></span>
          </button>
          <ul id="css-select" class="dropdown-menu" role="menu">
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js">Default</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation" class="dropdown-header">Bootswatch</li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/amelia/bootstrap.min.css">Amelia</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cerulean/bootstrap.min.css">Cerulean</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cosmo/bootstrap.min.css">Cosmo</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cyborg/bootstrap.min.css">Cyborg</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/flatly/bootstrap.min.css">Flatly</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/journal/bootstrap.min.css">Journal</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css">Readable</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/simplex/bootstrap.min.css">Simplex</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/slate/bootstrap.min.css">Slate</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/spacelab/bootstrap.min.css">Spacelab</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/united/bootstrap.min.css">United</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/yeti/bootstrap.min.css">Yeti</a></li>
          </ul>
        </div>
    </div>

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-85.html">AVS</a></li>

      <li class="active">Normal AVS Code -&gt; loop() code translator</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173672">Normal AVS Code -&gt; loop() code translator</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">17th March 2004 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><strong>Normal AVS Code -&gt; loop() code translator</strong><br />
      I wrote a little program that I think one of you might be able to use :)<br />
      It takes any (valid) AVS code and transforms it into either<br />
      - a nicely readable 1 assignment/command per line form,<br />
      - a not so nicely readable 1 assign()/command per line form<br />
      - a mix of assign()s and exec3()s which will most likely be unreadable but compatible to loop() :)<br />
      All of these forms are equivalent and as syntactically correct as the input ;)<br />
      <br />
      You can then use the code in the following form:<br /></p>
      <pre>
<code><br />loop(n, &lt;output of my program&gt;);<br /></code>
</pre><br />
      <br />
      You can also use the generated code for if blocks if you want :)<br />
      <pre>
<code><br />if(cond, &lt;output of my program for the true branch&gt;, &lt;output of my program for the false branch&gt;);<br /></code>
</pre><br />
      <br />
      I provided the source (VB6) so you can alter the program to suit your needs or even improve it ;)<br />
      Just give me credit if you use it in an AVS :)<br />
      <br />
      You will need a VB6 runtime DLL (msvbvm60.dll) for this!<br />
      [edit]You can download it <a href="http://download.microsoft.com/download/vb60pro/Redist/sp5/WIN98Me/EN-US/VBRun60sp5.exe" target="_blank">here</a>[/edit]<br />
      [edit]I removed the OLE automation stuff so you only need msvbvm60.dll now.[/edit]<br />
      [edit]changed the interface a bit :)[/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">S-uper_T-oast</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 03:01 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">From the way I read this, it sounds like a good thing... I will see how it works after a little bit of tinkering and report back later.<br />
      <br />
      //added//<br />
      It works as far as I can tell, no matter what code I throw at it, it works. I could see how this would be useful for some odd ball things, but I personally can't see any use for it right now.<br />
      <br />
      Request-Allow for comment ,// */ /*, support.<br />
      //added//</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 03:30 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">// and /*...*/ should be no problem... this is treated as a part of the next command or of the next variable of the assignment<br />
      it will look a bit strange but it should work i think :)<br /></p>
      <pre>
<code><br />a=b; /* comment */<br />c=d;<br /></code>
</pre><br />
      becomes<br />
      <pre>
<code><br />exec2(assign(a,b),assign(/* comment */<br />c,d))<br /></code>
</pre><br />
      which works, too :)<br />
      <pre>
<code><br />a=b; // comment<br />c=d;<br /></code>
</pre><br />
      becomes<br />
      <pre>
<code><br />exec2(assign(a,b),assign(// comment<br />c,d))<br /></code>
</pre><br />
      <br />
      that' also valid, equivalent code<br />
      <br />
      I could write something to filter the comments out if you want that. should be no problem :)<br />
      <br />
      and btw: save your original code, it will be very hard to edit the code my program generates, as it does not structure it at all ;)<br />
      <br />
      I'm going to make it convert something like "loop(1,a=b);" to "loop(1,assign(a,b));" so you can write whole code blocks and then let my program translate them. :) I'll need to make the whole thing recursive but that would allow one to write actually readable code with loop()s in it :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jheriko</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 05:19 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Nice idea.. but don't expect credit for making something easier that anyone could do otherwise. Do I credit Paint Shop Pro's authors when I use it to convert a .jpg to a .gif? I'd use this if you let me do so without credit.. otherwise I'd rather do it the long way than mention your name in an AVS comment when you had nothing to do with the actual preset or its code.<br />
      <br />
      It is a really good idea though.. unfortunately I can't see any situation where I'd need to loop and enormous block of code without having a really slow preset.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 05:41 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">It's done :)<br />
      <br />
      You can now check a box to filter comments and you can now write things like<br />
      <br /></p>
      <pre>
<code><br />loop(a=x+15,<br />  a=b;<br />  c=d;<br />  e=f<br />);<br /></code>
</pre><br />
      which is transformed to<br />
      <pre>
<code><br />loop(assign(a,x+15),exec3(assign(a,b),assign(c,d),assign(e,f)))<br /></code>
</pre><br />
      <br />
      <br />
      or even cascade the loops<br />
      <pre>
<code><br />loop(y=x+15,<br />  a=b;<br />  loop(u=v-1,<br />    c=d;<br />    e=f<br />  )<br />);<br /></code>
</pre><br />
      to get this:<br />
      <pre>
<code><br />loop(assign(y,x+15),exec2(assign(a,b),loop(assign(u,v-1),exec2(assign(c,d),assign(e,f)))))<br /></code>
</pre><br />
      <br />
      The indentation is not necessary btw ;)<br />
      <br />
      [edit]<br />
      jheriko: hmm just mention that you used the program somewhere in the comments, so people know you went the short way, i think that's just fair. ;)<br />
      and about the usage...<br />
      you could actually speed up your presets by using translated conditional blocks like<br />
      <pre>
<code><br />if(cond,a=b;c=d,e=f;g=h)<br /> ||<br /> \/<br />if(cond,exec2(assign(a,b),assign(c,d)),exec2(assign(e,f),assign(g,h)))<br /></code>
</pre><br />
      and finally you can use big loops in Init or not so big loops in Frame.<br />
      [/edit]<br />
      [edit]<br />
      small bugfix: doesn't crash anymore when entering code with syntax errors :)<br />
      [/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><strong>bugfix</strong><br />
      i fixed a (quite stupid :) ) bug in the comment filtering routine that caused it to loop infinitely (in other words: freeze ;) ) on nearly all combinations of comments (except those i tested *g*)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">It's much easier to just use assign()+assign()+assign()+... rather than nested exec3's and exec2's IMO.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">that's true but it's probably slower :)<br />
      since i wrote this program for loop()s at first i decided to use the exec()s<br />
      [edit]I'll make a checkbox for that :)[/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">sorry for double posting but I forgot to add the new version :)<br />
      another improvement:<br />
      you can now choose not to translate the first level of commands, allowing you to translate whole preset blocks of this form:<br />
      <br /></p>
      <pre>
<code><br />code;<br />more=code;<br />loop(n,<br />  code(looped);<br />  count=count+1;<br />);<br />even=more+code;<br />still(code,here);<br /></code>
</pre><br />
      with the checkbox "Translate first level" unchecked this is translated to:<br />
      <pre>
<code><br />code;<br />more=code;<br />loop(n,exec2(code(looped),assign(count,count+1)));<br />even=more+code;<br />still(code,here);<br /></code>
</pre><br />
      <br />
      [edit]added the new translation mode UnConeD suggested[/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Warrior of the Light</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Sweet stuff here! Really useful!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">skupers</span><br /></p>

      <p class="post-time small text-muted">18th March 2004 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Very handy. Thanks for making this!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shock Value</span><br /></p>

      <p class="post-time small text-muted">19th March 2004 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Very nice! This is an excellent tool that will be used A LOT (at least by me). It's so tricky to write code in nested loops and not have parentheses missing (or too many) that prevent compilation. This solves all of that! You are definitely going to get some credit in the credits of my next pack, because this makes creating code-driven AVS presets much more straightforward. I only wish it would have been out sooner, because I just got done making an extremely complicated preset that used a ton of code and I used plenty of time debugging mistyped code.<br />
      <br />
      EDIT: I just tried converting about 200 lines of code in that preset to exec2/3's (just for fun). It worked perfectly, so I can almost 100% confirm there are no bugs in this program (although my original code had no comments, so that feature is untested by me).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">19th March 2004 04:46 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">the comment filter should work flawlessly because it's not that complex :) the filtering is done before all parsing and just looks for /* and deletes everything until the next */ it finds. nested /* */ aren't valid in AVS anyway ;)<br />
      and it looks for // and deletes everything until the next CR+LF.<br />
      Erm ok there is one issue with the comment filter: please dont use the string "fgsfoihjoadas" anywhere in the input because it will be replaced by a slash :)<br />
      <br />
      after all of these constructed mini-examples here's a real example that might give you an idea of what you could do with the program. here's one of my presets i wrote with my tool. It's mainly for testing purposes since it has no beat reaction or own movement :)<br />
      It's a reflective sphere and a plane. the camera can be controlled by the mouse (hold left mouse button down to pan the camera) and the keyboard (cursor keys to move around).<br />
      <br />
      the main raytracing code is contained in these 2 nice if()s: :)<br /></p>
      <pre>
<code><br />if(bplane,assign(isplane,1),exec3(exec3(exec3(assign(kdist,<br />(sqr(dx) + sqr(dy) + sqr(dz))),assign(kp , (2*dx*(ox-mx) + <br />2*dy*(oy-my) + 2*dz*(oz-mz))/kdist),assign(kq , (sqr(ox-mx)<br />+sqr(oy-my)+sqr(oz-mz)-sqr(rad))/kdist)),exec3(assign<br />(kdet,sqr(kp/2)-kq),assign(k1,-kp/2+sqrt(kdet)),assign(k2,-<br />kp/2-sqrt(kdet))),exec3(assign(k1,if(below<br />(k1,0),INFIN,k1)),assign(k2,if(below(k2,0),INFIN,k2)),assign<br />(ksphere,min(k1,k2)))),exec3(exec3(assign<br />(ax,dx*ksphere),assign(ikx,ax+ox),assign<br />(ay,dy*ksphere)),exec3(assign(iky,ay+oy),assign<br />(az,dz*ksphere),assign(ikz,az+oz)),exec3(assign(xdist,ikx-<br />mx),assign(ydist,iky-my),assign(zdist,ikz-mz))),exec2(assign<br />(distkugel,sqrt(sqr(xdist)+sqr(ydist)+sqr(zdist))),assign<br />(isplane,above(abs(rad-distkugel),epsilon)))));<br /><br />if(isplane,exec2(exec3(exec3(assign(pa,0),assign<br />(pb,0),assign(pc,1)),exec3(assign(pd,-40),assign(k1,(-pa*ox-<br />pb*oy-pc*oz-pd)/(pa*dx + pb*dy + pc*dz)),assign(kplane,if<br />(below(k1,0),INFIN,k1))),exec3(assign(k,kplane),assign<br />(ix,dx*kplane+ox),assign(iy,dy*kplane+oy))),assign<br />(iz,dz*kplane+oz)),exec3(exec3(exec3(assign<br />(k,ksphere),assign(ar,invsqrt(sqr(ax)+sqr(ay)+sqr<br />(az))),assign(ax,ax*ar)),exec3(assign(ay,ay*ar),assign<br />(az,az*ar),assign(nx,ikx-mx)),exec3(assign(ny,iky-my),assign<br />(nz,ikz-mz),assign(nr,invsqrt(sqr(nx)+sqr(ny)+sqr<br />(nz))))),exec3(exec3(assign(nx,nx*nr),assign<br />(ny,ny*nr),assign(nz,nz*nr)),exec3(assign(bx,nx-(ax-<br />nx)),assign(by,ny-(ay-ny)),assign(bz,nz-(az-nz))),exec3<br />(assign(k1,(-pa*ikx-pb*iky-pc*ikz-pd)/(pa*bx + pb*by + <br />pc*bz)),assign(kplane2,if(below(k1,0),INFIN,k1)),assign<br />(ix,bx*kplane2+ikx))),exec2(assign(iy,by*kplane2+iky),assign<br />(iz,bz*kplane2+ikz))));<br /></code>
</pre><br />
      <br />
      The first if() makes sure the sphere is only raytraced if the viewer is not on the wrong side of the plane.<br />
      The second if() does the reflection calculations only if the sphere is actually hit (anyone got better code for determining this instead of the approximating code? :) ).<br />
      <br />
      The non-translated code is provided in the comments after the DM and the Texer II respectively.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">19th March 2004 05:16 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">forgot the attachment *g*</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">19th March 2004 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><strong>download site</strong><br />
      i made a download site for AVSTrans <a href="http://www.geocities.com/tomyloboavs" target="_blank">here</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">your-dentist</span><br /></p>

      <p class="post-time small text-muted">19th March 2004 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">hm, usefull, really!<br />
      this programm is very helpfull when using e.g. whittaker iteration (or othe iterations) on raytracing presets.<br />
      some kind of back-converter that can convert the generated code back mortal winamp code.<br />
      nochwas: tomy, du kannst doch so gut proggen. bitte schreib mal ein programm welches syntax-fehler im AVS code markiert. fehlersuche in superscopes etc. stress manchmal wirklich, da bei einem fehler einfach garnix gemacht wird. bis gleich!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jheriko</span><br /></p>

      <p class="post-time small text-muted">24th March 2004 23:57 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Never thought of using code inside ifs like that to optimise stuff so heavily. I suppose containing massive blocks of code inside ifs is a really efficient way of dealing with some things.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">25th March 2004 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">@your-dentist<br />
      (he asked me to write an AVS syntax checker)<br />
      Such a syntax checker is already integrated in AVS.<br />
      Open Settings/Debug Window... and check the "Log compile errors" checkbox.<br />
      AVS will then display all erronous code in the "Recent eval code errors" box as soon as you change something in the code in question<br />
      <br />
      So nen Syntaxchecker ist schon in AVS integriert.<br />
      Geh mal auf Settings/Debug Window... und aktivier mal "Log compile errors"<br />
      Dann zeigt dir AVS sämtlichen fehlerhaften code in der "Recent eval code errors" Box sobald du den fragliche code änderst.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zevensoft</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><a href="http://zevensoft.no-ip.com/filedump/avs/codeconvert.exe" target="_blank">http://zevensoft.no-ip.com/filedump/avs/codeconvert.exe</a><br />
      <br />
      Can convert VB6 code into AVS.<br />
      Atm only supports dim, global, private, for/next, and =.<br />
      Other statements will be left intact.<br />
      <br />
      Example:<br /></p>
      <pre>
<code><br />dim a(100)<br />global b()<br /><br />for n = 0 to 100<br />   a((n+1)%100) = b(n)<br />next n<br /></code>
</pre><br />
      Will create avs code that does the same.<br />
      <br />
      Note that you need to enable interlaced arrays for dynamic<br />
      arrays, as I haven't coded a dynamic memory manager yet. And I cbf coding it either.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Nice idea Zevensoft<br />
      <br />
      I picked out some advantages and disadvantages of using your program instead of mine:<br />
      <br />
      advantages:<br />
      - you don't have to learn the AVS language<br />
      - you can use (parts of) existing VB6 programs directly in AVS<br />
      - easy (g)megabuf handling<br />
      <br />
      disadvantages:<br />
      - you have to learn VB6 ;)<br />
      - with the easy (g)megabuf handling of your program you don't know what is in your (g)megabuf and where, so you have to write the whole code in VB6<br />
      - you have to convert AVS code to VB6 (which your program can't do yet) to use it in your program<br />
      - you don't work close to the AVS language anymore and it's hard to optimize your program's output. this is also true for my program, but you can optimize before translating as my program doesn't add any extra commands. I tested that: "a=b; c=d;" and "exec2(assign(a,b),assign(c,d));" both generate 37 bytes code<br />
      - your program always creates assign(...)+assign(...), which is slighty slower than the exec2/3() blocks my program creates (feel free to take the "mkexecs" function from my program to achieve this, it needs to be called until the array of commands has only 1 element left)<br /></p>
      <pre>
<code><br />While UBound(outField) &gt; 0<br />    outField = mkexecs(outField)<br />Wend<br />tmpExecForm = outField(0)<br /></code>
</pre><br />
      (assumes LBound(outField) = 0)<br />
      - your program only supports a finite number of flow control operations. For example if Nullsoft decided to implement something like While...Wend from VB6 in AVS, you have to change your program. I don't need to change mine because it accepts assignments inside all functions. you could for example write<br />
      <pre>
<code><br />a=b;<br />c=getosc(<br />  d=e<br />,<br />  f=g<br />,<br />  h=i<br />)<br /></code>
</pre><br />
      in my program and it would convert it to strange but working AVS code.<br />
      <br />
      Bugs(or maybe not yet implemented features? :) ) I found:<br />
      <br />
      That code example you supplied is not VB6 but it looks like VB6<br />
      VB6 needs ReDims for dynamic arrays and you write MOD instead of %<br />
      try this for the modulo problem:<br />
      <pre>
<code><br />Temp = Join(Split(" mod ", Input, , vbTextCompare), "%")<br /></code>
</pre><br />
      this replaces " mod " (case insensitive) by "%", which should be enough since the VB6 IDE formats the code this way...<br />
      <br />
      try to convert<br />
      <pre>
<code><br />a=b:b=c<br /></code>
</pre><br />
      it won't work... multiple commands in 1 line are sometimes needed in order to preserve clarity<br />
      <br />
      btw your program generates an "index out of range" error for this code:<br />
      <pre>
<code><br />for i=1 to 2<br />  a=b<br />next i<br /></code>
</pre><br />
      fix this :)<br />
      <br />
      Your program doesn't support comments (yet). Try using a modified version of the FilterComments() function in my program if you want. (assume FilterAll = True and remove everything that is not executed with this assumption to leave out all the stuff i use for the Comment Codes)<br />
      <br />
      btw there's a new version (1.8.01) on my <a href="http://tomylobo.de.vu" target="_blank">page</a> and I will put 1.9.00 there, soon, which will support easier megabuf assignments. I'm starting to write this now :)<br />
      <br />
      [edit]<br />
      Hmm this was 2 lines of code added.<br />
      The uploading was the hardest part :)<br />
      [/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shock Value</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">I can't seem to get the "Auto Clipboard" feature working, which is a shame because it sounds like a really useful idea. I've tried playing with the checkboxes and the //$DoAutoClipboard comment but copying and pasting code does not run it through your converter no matter what I do.<br />
      <br />
      EDIT: I'm using version 1.9.00.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Hmm it works for me...<br />
      I started AVSTrans and activated the "Auto-Clipboard mode" checkbox and copied this into the clipboard:<br /></p>
      <pre>
<code><br />//$DoAutoClipboard<br />a=b<br /></code>
</pre><br />
      and pasted it somewhere else and got<br />
      <pre>
<code><br />assign(a,b)<br /></code>
</pre><br />
      <br />
      [edit]<br />
      the DoAutoClipboard comment needs to be in the clipboard, NOT in the input box<br />
      [/edit]<br />
      <br />
      Auto-Clipboard mode scans the clipboard once in a second, this means that you'll need to wait up to 1 second to get the converted code, so don't paste too fast :)<br />
      <br />
      Make sure you checked the "Translate first level" checkbox if you use normal AVS code as input (without something like "loop(n,a=b)")<br />
      <br />
      Also check the spelling of "//$DoAutoClipboard" and try to put it in the first line (should normally not be necessary but it's worth a try)<br />
      Another problem might be clipboard managers... I don't have one of them installed so i don't know how they work but they might interfer with the Auto-Clipboard mode of my program.<br />
      <br />
      Try to normally convert the code in question using the input box and see if there are errors (normally auto-clipboard mode should do exactly the same as pasting the code into the input box and copying it from the output box, but something might have been messed up, so please try that too :) )
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shock Value</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Oh, OK it works now. I thought the comment code only had to be in the input box for some reason.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">27th March 2004 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">i made the DoAutoClipboard thing to prevent AVSTrans from translating everything in the clipboard: URLs, your documents, pictures :)<br />
      <br />
      [edit]<br />
      I updated the CHANGELOG on the website (not in the .zip) and removed some ambiguities regarding the placement of the DoAutoClipboard comment :)<br />
      [/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">4th April 2004 07:01 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><strong>new version</strong><br />
      I added a new feature to AVSTrans: Replacements.<br />
      You can now add special Comment Codes to your code that tell AVSTrans to replace any occurance of a string in the code by another string. Read the <a href="http://www.geocities.com/tomyloboavs/CHANGELOG.txt" target="_blank">CHANGELOG</a> for details<br />
      You can download AVSTrans 1.10.00 <a href="http://www.geocities.com/tomyloboavs" target="_blank">here</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br /></p>

      <p class="post-time small text-muted">7th April 2004 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">i think this is pretty pointless...people should be able to translate their code themselves. also, exec2(,) and exec3(,,) are useless afaik, cos assign(,)+assign(,)+assign(,) ... does the same thing without the extra computation of another function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">7th April 2004 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">the AVS evaluator compiles your code to machine code and stores it for execution<br />
      knowing that, it should be clear that it's actually the other way round:<br />
      that + sign generates an ADD instruction, while the execs are just another way to write semicolon separated assign()s. they are not "calculated"<br />
      you can also test it:<br />
      make a new .avs, add a SSC, write some code in it, look at the Eval code stats in the debug window.<br />
      it says xxxx+xxx bytes code<br />
      next, copy your code to AVSTrans and let it translate it into execs.<br />
      replace the SSC code with these execs and look at the Eval code stats in the debug window again:<br />
      no change :eek:<br />
      still the same code length, and thus the same execution speed<br />
      <br />
      now try the same with the assign+assign method and you should notice an increase in the code length, which is caused by the ADD instructions i mentioned above.<br />
      <br />
      and about translating your code manually: you did probably not read the whole thread as i posted a quite complex example (raytracing with some if blocks to increase speed) try that manually :) if you do this without errors, you're a genius<br />
      the code will probably be erronous because you forgot a bracket, comma or the likes somewhere<br />
      the example is <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?postid=1309178#post1309178" target="_blank">here</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">8th April 2004 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Atero, I think I've said this about a hundred times or so: stop nagging about extra function calls or whatever in AVS. And now, you don't have the excuse of not having the source code. Get yourself the 5.02 AVS SDK and take a look at nseel-cfunc.c. Now you know exactly what all that code in AVS does.<br />
      <br />
      Almost all functions now result in direct compiled code without jumps or calls. Only complicated math operations such as the arctrig functions or pow/exp cause actual jumps into external code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">D12</span><br /></p>

      <p class="post-time small text-muted">9th April 2004 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">I am confuse. sorry I don't undrastand some parts of it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jheriko</span><br /></p>

      <p class="post-time small text-muted">10th April 2004 05:38 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Atero</i><br />
        <b>i think this is pretty pointless...people should be able to translate their code themselves. also, exec2(,) and exec3(,,) are useless afaik, cos assign(,)+assign(,)+assign(,) ... does the same thing without the extra computation of another function.</b>
      </blockquote>what computation does exec2/3 do?<br />
      <br />
      what computation does + do?<br />
      <br />
      is + a function?<br />
      <br />
      think about it carefully. i dont even need to look in the source on this one.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sidd</span><br /></p>

      <p class="post-time small text-muted">10th April 2004 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">mmmh<br />
      <br />
      + is a floating point add, which is a few cycles, exec2 is just fetching instructions and putting the last value in the active register, so its practically nothing in cpu cycles. But you would have to do a fair bit of it do notice a difference.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">10th April 2004 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">like 20 lines of code in a loop(100)? :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br /></p>

      <p class="post-time small text-muted">11th April 2004 03:44 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">i heard it the first time, christ...x_x</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fsk</span><br /></p>

      <p class="post-time small text-muted">12th April 2004 03:31 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">this kicks ass:)<br />
      probably gona save me alot of nervous breakdowns:D<br />
      <br />
      what about support for stuff like<br />
      a&lt;b<br />
      a==b<br />
      for the ifs?<br />
      i just hate the damn equal(bla,bla)stuff<br />
      <br />
      nah this is a stupid idea i gues cause theat would just make it another language, nm:)<br />
      <br />
      nice work dood:thubs up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">12th April 2004 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">hmm... a&lt;b and a==b and the likes would be quite hard to code. I'd have to parse the whole string for something like == &gt; &lt;<br />
      i'd also have to respect precedence<br />
      (a+b)==(c+d)<br />
      and<br />
      a+b==c+d<br />
      don't have to be the same :)<br />
      <br />
      atm all functions are treated equally: first, they're split to command name and parameter list<br />
      commandname(parameterlist)<br />
      the program looks for commas and keeps track of the bracket level. If it finds a comma and the current bracket level is 0, the string up to the comma is taken as a command block and translated recursively. when the translation returns, the command is composed from the the command name and the translated parameters.<br />
      <br />
      If someone has a good parsing/replacement algorithm for the comparisons, i'll put it into the program (provided, i have the permission to do so :) ).<br />
      Needed is basically something that takes an AVS command block as input and replaces all occurances of some+term-goes*here==another+term-goes*here by equal(some+term-goes*here,another+term-goes*here)<br />
      The programming language can be VB, VBA, PHP, Perl, C/++, Pascal/Delphi/Kylix, J(ava)Script, VBScript, and maybe even Java :)<br />
      (ordered from best to worst :) )<br />
      <br />
      I also found out that some bugs cause certain combinations of code not to translate to what i intended, namely:<br /></p>
      <pre>
<code><br />loop(5,<br />  somefn(param);<br />  otherfn(param);<br />);<br /></code>
</pre><br />
      does not translate correctly<br />
      <br />
      <pre>
<code><br />a=b+loop(5,<br />  assign(a,b);<br />  assign(a,b);<br />  c=d;<br />);<br /></code>
</pre><br />
      generates an ERR<br />
      <br />
      both result from a simple (and quite stupid :D ) bug and are fixed in 1.10.01<br />
      see CHANGELOG.txt for details :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryskull</span><br /></p>

      <p class="post-time small text-muted">12th April 2004 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"></p>

      <blockquote>
        what about support for stuff like<br />
        a&lt;b<br />
        a==b<br />
        for the ifs?<br />
        i just hate the damn equal(bla,bla)stuff
      </blockquote>That would be awesome, above(bla,bla) and that crap wastes code space, and those brackets are so annoying.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OnionRingOfDoom</span><br /></p>

      <p class="post-time small text-muted">13th April 2004 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Whooo! Now maybe this'll finally help me understand the whole array thing!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">13th April 2004 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">array thing? you mean (g)megabuf?<br />
      it's simple:<br />
      A (g)megabuf can be seen as a collection of variables (1 million of them :) )<br />
      that can be addressed by using an index.<br />
      <br />
      Syntax:<br />
      without AVSTrans:<br />
      local (only available in this specific component):<br /></p>
      <pre>
<code><br />assign(megabuf(index), value); // assigns "value" to megabuf entry #index<br />variable = megabuf(index); // assigns the value of megabuf entry #index to "variable"<br /></code>
</pre><br />
      <br />
      global (shared between the components)<br />
      local (only available in this specific component):<br />
      <pre>
<code><br />assign(gmegabuf(index), value); // assigns "value" to gmegabuf entry #index<br />variable = gmegabuf(index); // assigns the value of gmegabuf entry #index to "variable"<br /></code>
</pre><br />
      <br />
      with AVSTrans 1.11.00:<br />
      like the above or:<br />
      local:<br />
      <pre>
<code><br />megabuf[index] = value; // assigns "value" to megabuf entry #index<br />variable = megabuf[index]; // assigns the value of megabuf entry #index to "variable"<br /></code>
</pre><br />
      <br />
      global:<br />
      <pre>
<code><br />gmegabuf[index] = value; // assigns "value" to gmegabuf entry #index<br />variable = gmegabuf[index]; // assigns the value of gmegabuf entry #index to "variable"<br /></code>
</pre><br />
      note that the above only counts for the newest version (1.11.00) where I fixed that thing i mentioned in the 1.09.00 CHANGELOG entry about those brackets that were needed before 1.11.00.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sidd</span><br /></p>

      <p class="post-time small text-muted">13th April 2004 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">i can see myself getting too used to coding with this, then traslating :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">14th April 2004 05:40 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">there is a serious bug in 1.11.00!<br />
      everything is fine as long as you dont use the recursing parser (i.e. write things like loop(n,a=b); )<br />
      I'm working on a solution just now<br />
      <br />
      [edit]<br />
      The new version (1.11.01) is ready, and is available <a href="http://www.geocities.com/tomyloboavs" target="_blank">here</a><br />
      The bug mentioned above isn't limited to the recursing parser, but everything should work fine now with the new version.<br />
      [/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">14th April 2004 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><a href="http://www.geocities.com/tomyloboavs" target="_blank">1.11.02 is available</a> and fixes another bug in the recursing parser. i think i've got all of them now :)<br />
      <br />
      [edit]<br />
      <a href="http://www.geocities.com/tomyloboavs" target="_blank">1.11.02 is done</a> and implements a bracketing check that will mark errors instead of just displaying nothing or even crashing on them ;)<br />
      if it finds a bracketing error, it marks the whole block with<br /></p>
      <pre>
<code><br />BRACKETS(n)-&gt;erronous code&lt;-BRACKETS<br /></code>
</pre><br />
      where n is the number of brackets missing (negative numbers mean too much brackets)<br />
      no translations are done if there is a bracketing error<br />
      [/edit]<br />
      <br />
      [edit]<br />
      <a href="http://www.geocities.com/tomyloboavs" target="_blank">yet another version (1.11.04)</a> *argh*<br />
      After all these structural changes I could now finally implement megabuf assignments the way i meant them to be :)<br />
      <pre>
<code><br />megabuf(index)=value<br /></code>
</pre><br />
      with *round* brackets instead of square brackets :)<br />
      They already worked in 1.11.02 but with the restriction I explained in the 1st addition to the 1.09.00 entry<br />
      [/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fragmer</span><br /></p>

      <p class="post-time small text-muted">15th April 2004 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">why do you use the bufdist thing in texer2 in your example?<br />
      imho it's easier and fSaster to use</p>
      <pre>
<code><br />megabuf(t);<br />megabuf(t+n);<br />megabuf(t+n2); // etc.<br /></code>
</pre><br />
      ...where t varies from 0 to (n-1).<br />
      n*2, n*3 etc can be pre-calculated on ini.<br />
      ex.: buggyAVS2 &gt;&gt; particles-II
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">15th April 2004 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">The base structure of that texer is quite old *g*<br />
      I'd write this differently if i did this now :)<br />
      It's just 5 points in that texer2... I really don't need to optimize that, do i? :)<br />
      atm I'm working on a pattern replacement algorithm for AVSTrans, which would allow writing things like<br /></p>
      <pre>
<code><br />//$AVSTrans_Replacement_Pattern=variable([a-z*/-+()])-&gt;megabuf($1+n2)<br />a=variable(b);<br />variable(c)=d;<br /></code>
</pre><br />
      so i think I'm going to switch over to the t+n2 technique, because the interleaving technique(t*n+1) i'm using now is quite hard to pre-cache/optimize if i use pattern matching :(
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TomyLobo</span><br /></p>

      <p class="post-time small text-muted">15th April 2004 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><a href="http://www.geocities.com/tomyloboavs" target="_blank">AVSTrans 1.12.00</a> is out :)<br />
      Most noticable new feature: Regular Expression Matching/Replacement .<br />
      I'm using the RegEx Object from VBScript for that.<br />
      For a description of the available Expressions look at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/script56/html/vspropattern.asp" target="_blank">the corresponding MSDN site</a>.<br />
      <br />
      The syntax is<br /></p>
      <pre>
<code><br />//$AVSTrans_Replacement_Pattern=pattern-&gt;replacevar<br /></code>
</pre><br />
      the replacevar may contain things like $1 to get the remembered matches described in the "(pattern)" line in the MSDN document.<br />
      <br />
      a (working) example :<br />
      <pre>
<code><br />//$AVSTrans_Replacement_Pattern=variable\(([^\)]*)\)-&gt;megabuf($1+n2)<br />a=b;<br />variable(ab)=d;<br />e=f<br /></code>
</pre><br />
      this translates to<br />
      <pre>
<code><br />a=b;<br />assign(megabuf(ab+n2),d);<br />e=f<br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
    </div>
  </div><!-- Put JavaScript here -->
  <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="../js/jquery.cookie.min.js"></script>
  <script type="text/javascript" src="../js/scripts.js"></script>
</body>
</html>
