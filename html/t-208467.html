<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="calculation-speed comparison"><title>calculation-speed comparison - AVS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-7','auto');ga('send','pageview');</script><link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"></head><body style="display:none"><div class="container"><div class="row"><div class="dropdown pull-right"><button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">Change style <span class="caret"></span></button><ul id="css-select" class="dropdown-menu" role="menu"><li><a href="#" rel="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">Default</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Bootswatch</li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/amelia/bootstrap.min.css">Amelia</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css">Cerulean</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css">Cosmo</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cyborg/bootstrap.min.css">Cyborg</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css">Flatly</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css">Journal</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css">Readable</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css">Simplex</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/slate/bootstrap.min.css">Slate</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css">Spacelab</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css">United</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css">Yeti</a></li></ul></div></div><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-139.html">AVS Troubleshooting</a></li><li class="active">calculation-speed comparison</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208467">calculation-speed comparison</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">^..^</span><br></p><p class="post-time small text-muted">21st February 2005 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"><strong>calculation-speed comparison</strong><br>Just now we discussed whether a calculation of sines in init and storing them in megabuf or calculating them directly in point would be faster. So i tried to make a preset to compare both kinds. Unfortunately i don't get it to work. It'd be kind if someone could check where in the code i made the mistake.<br>Thanks a lot!<br><br>/edit: i know that i "deactivated" one line of code using "//", but that's not the mistake...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">UnConeD</span><br></p><p class="post-time small text-muted">22nd February 2005 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Note that such a comparison is not good, as you need to compare them in a realistic environment: i.e. inside a complicated preset.<br><br>With just a simple circle like this, the entire sin table probably fits into the cache so the megabuf seems faster. But in a realistic preset with lots of code, the megabuf can get swapped out of the cache.<br><br>As far as the code goes, the problem is simple. You do: exec2(index+1, ...)<br><br>This doesn't do anything, it should be exec2(assign(index,index+1), ...)<br><br>Some notes:<br><br>- When using megabuf indexes, you should cast them to integers with floor(). For example if you have (i*$pi*2)*2 items with even and odd items, you need to do floor(i*$pi*2)*2 and floor(i*pi*2)*2+1. Otherwise you have no guarantee that (i*$pi*2)*2 is an even item.<br>- You don't reset the_count and index in your scope, which means it only has the right values the first time. Perhaps the mod takes care of it, but you should be on the safe side anyway, becuase typically the amount of points has no relation to the size of the lookup table. This is only because you're drawing a circle.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">^..^</span><br></p><p class="post-time small text-muted">22nd February 2005 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Thanks!<br>What a simple problem... But as i said i'm not yet 100% familiar with this kind of code. Bout the circle: i chose the simplest shape that uses a sin, to just get the code to work, then i wanted to "complicate" it.<br><br>Also thanks for the tips! Actually the modulus should reset the counter, isn't it a reliable operator?<br><br>One word about my idea of the table: as avs never does an continous calcultion (variables don't increase on infinite small amounts, they increase on predefined steps like "+0.02 per frame", dont' they?) it's always only approximate if you draw a shape that way, so the megabuf could offer a self defined exact list of sin-values. This list will get as big as you want it to be detailled, cause sin actually is a periodic function, (sin(x) is the same like sin(x+2*pi)). So only the values in the bounds of 0 and 2*pi have to be stored. All further x values wont have different sines.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p><p class="post-time small text-muted">23rd February 2005 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">coned is right, the code page will get swapped out of cache after a certain size so a propper test needs a lot of code. I'm trying to think of a robust but simple idea for a test preset, if only AVS had nop's it would be a lot easier, perhaps a load of useless assignments to a LOT of different variables to really fill up the stack/heap and push the memory usage out of just cache, and it would also make sufficiently large code pages.<br><br>edit: I forgot to say, ^..^'s test is still valid to a point, because if he isnt going to make complicated presets he doesnt need a complicated test. Its still not a very useful test tho.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">^..^</span><br></p><p class="post-time small text-muted">23rd February 2005 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">well, at first i wanted to get the code in init to work. After that the code should become more "demanding"...<br>However i don't have good idea for that. I would ask you for help, but as i know you're quite busy at the moment. So i'll postpone this idea for the time being. Besides, i don't have that much free time either...<br><br>btw what are "nop's"?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p><p class="post-time small text-muted">23rd February 2005 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">nop is an asm mnemonic that stands for no operation. If AVS had them you could just paste a few thousand nops which would make the code pages really big (assuming evallib didnt optimise them out). But it doesnt, so you cant.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">^..^</span><br></p><p class="post-time small text-muted">23rd February 2005 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">thanks!<br>besides, are you really reeeaally curious about knowing wich code-type is faster? cause i did this as an exercise at first, but somehow i lost that "initial ambition"... ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PAK-9</span><br></p><p class="post-time small text-muted">24th February 2005 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">I'm not really that curious because I'm 95% sure a sine will be slower. I would be borderline gobsmacked if a megabuf retrieval turned out to be slower.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">^..^</span><br></p><p class="post-time small text-muted">24th February 2005 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">but unconed's explanation also seems logical to me...<br>Perhaps i'll work further on a useful test-preset, if i get a idea what to use as "benchmark code"..</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" defer></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" defer></script><script type="text/javascript" src="../js/jquery.cookie.min.js" defer></script><script type="text/javascript" src="../js/scripts.js" defer></script></body></html>