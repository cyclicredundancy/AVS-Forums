<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="wanna create a single cube"><title>wanna create a single cube - AVS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-7','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"></noscript> <script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body style="display:none"><div class="container"><div class="row"><div class="dropdown pull-right"><button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">Change style <span class="caret"></span></button><ul id="css-select" class="dropdown-menu" role="menu"><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">Default</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Bootswatch</li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/amelia/bootstrap.min.css">Amelia</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css">Cerulean</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css">Cosmo</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cyborg/bootstrap.min.css">Cyborg</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css">Flatly</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css">Journal</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css">Readable</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css">Simplex</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/slate/bootstrap.min.css">Slate</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css">Spacelab</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css">United</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css">Yeti</a></li></ul></div></div><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-85.html">AVS</a></li><li class="active">wanna create a single cube</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302235">wanna create a single cube</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">micro.D</span><br></p><p class="post-time small text-muted">19th January 2009 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"><strong>wanna create a single cube</strong><br>ok i give up i want to create a preset what relies on cubes so i wrote something and after 2 hours of searching what's wrong with this code (because it displays nothing instead of a cube) i decided to shout out loudly "HELP!":<br>first i wanted to define the cube by its width, height and depth (the first 3 values of cube() ) then define its position in "space" (cntrx,~y,~z) then comes its position in megabuf (idc) (if i wanted more cubes) and than the "global" offset in megabuf (offsc) (and there is an offs0 variable what is an offset for my hmm let's call it some kind of beat detection... simply ignore it now)<br></p><pre>
<code><br>&gt;&gt;&gt;&gt; avstrans's code:<br>001 #define mb(a) megabuf(a)<br>002 #define gmb(a) gmegabuf(a)<br>003 #define cube(wdth,hght,dpth,cntrx,cntry,cntrz,idc,offsc)<br>    mb(idc*24+offs0+offsc)=wdth*.5+cntrx;<br>    mb(idc*24+offs0+offsc+1)=hght*.5+cntry;<br>    mb(idc*24+offs0+offsc+2)=dpth*.5+cntrz;<br>    mb(idc*24+offs0+offsc+3)=wdth*.5+cntrx;<br>    mb(idc*24+offs0+offsc+4)=hght*.5+cntry;<br>    mb(idc*24+offs0+offsc+5)=-dpth*.5+cntrz;<br>    mb(idc*24+offs0+offsc+6)=wdth*.5+cntrx;<br>    mb(idc*24+offs0+offsc+7)=-hght*.5+cntry;<br>    mb(idc*24+offs0+offsc+8)=dpth*.5+cntrz;<br>    mb(idc*24+offs0+offsc+9)=wdth*.5+cntrx;<br>    mb(idc*24+offs0+offsc+10)=-hght*.5+cntry;<br>    mb(idc*24+offs0+offsc+11)=-dpth*.5+cntrz;<br>    mb(idc*24+offs0+offsc+12)=-wdth*.5+cntrx;<br>    mb(idc*24+offs0+offsc+13)=hght*.5+cntry...<br>    blablabla you can get the logic until mb(idc*24+offs0+offsc+23)<br>004 // read a vertex of a cube (idc is the cube "id", idcv is the chosen vertex of the cube)<br>005 #define cubvx(idc,idcv,offsc) mb(idc*24+offs0+offsc+max(idcv,7)*3)<br>006 #define cubvy(idc,idcv,offsc) mb(idc*24+offs0+offsc+max(idcv,7)*3+1)<br>007 #define cubvz(idc,idcv,offsc) mb(idc*24+offs0+offsc+max(idcv,7)*3+2)<br><br>&gt;&gt;&gt;&gt; triangle's code<br>&gt;&gt; init<br>001 n=12; zbuf=1; zbclear=1<br>&gt;&gt; frame<br>001 cube(getspec(cbls1,.01,0)*20,getspec(cbls2,.01,0)*20,getspec(cbls2,.01,0)*20,0,0,0,0,0);<br>002 rx=rx+rsp1*.1; ry=ry+rsp2*.1; rz=rz+rsp3*.1;<br>003 srx=sin(rx); crx=cos(rx); sry=sin(ry); cry=cos(ry); srz=sin(rz); crz=cos(rz);<br>004 trc=0; sw=0;<br>&gt;&gt; beat<br>001 cbsl1=rand(10)/20;<br>002 cbsl2=rand(10)/20;<br>003 cbsl2=rand(10)/20;<br>004 rsp1=rand(20)/20;<br>005 rsp2=rand(20)/20;<br>006 rsp3=rand(20)/20;<br></code>
</pre><br>
      so because i'm not so smart i cannot came out a better solution than telling all the triangles one-by-one that which vertex should choose from the above defined cube:<br>
      <pre>
<code><br>&gt;&gt; triangle<br>001 x1=below(trc,6)*cubvx(0,0,0)+below(trc,12)*cubvx(0,7,0)+);<br>002 x2=<br>    equal(trc,0)*cubvx(0,1,0)+<br>    equal(trc,1)*cubvx(0,2,0)+<br>    equal(trc,2)*cubvx(0,2,0)+<br>    equal(trc,3)*cubvx(0,4,0)+<br>    equal(trc,4)*cubvx(0,4,0)+<br>    equal(trc,5)*cubvx(0,1,0)+<br>    equal(trc,6)*cubvx(0,6,0)+<br>    equal(trc,7)*cubvx(0,5,0)+<br>    equal(trc,8)*cubvx(0,5,0)+<br>    equal(trc,9)*cubvx(0,3,0)+<br>    equal(trc,10)*cubvx(0,3,0)+<br>    equal(trc,11)*cubvx(0,6,0);<br>003 x3=<br>    equal(trc,0)*cubvx(0,3,0)+<br>    equal(trc,1)*cubvx(0,3,0)+<br>    equal(trc,2)*cubvx(0,6,0)+<br>    equal(trc,3)*cubvx(0,6,0)+<br>    equal(trc,4)*cubvx(0,5,0)+<br>    equal(trc,5)*cubvx(0,5,0)+<br>    equal(trc,6)*cubvx(0,4,0)+<br>    equal(trc,7)*cubvx(0,4,0)+<br>    equal(trc,8)*cubvx(0,1,0)+<br>    equal(trc,9)*cubvx(0,1,0)+<br>    equal(trc,10)*cubvx(0,2,0)+<br>    equal(trc,11)*cubvx(0,2,0);<br>    and so on for y1,2,3,z1,2,3 only difference is the cubvx changes to cubvy or cubvz<br><br>010 //and now comes the rotation (from the gvm-tools samples)<br>011 xa=x1*crz-y1*srz; ya=x1*srz+y1*crz; za=z1*cry-xa*sry;<br>    x1=z1*sry+xa*cry; y1=ya*crx-za*srx; z1=ya*srx+za*crx;<br>    xa=x2*crz-y2*srz; ya=x2*srz+y2*crz; za=z2*cry-xa*sry;<br>    x2=z2*sry+xa*cry; y2=ya*crx-za*srx; z2=ya*srx+za*crx;<br>    xa=x3*crz-y3*srz; ya=x3*srz+y3*crz; za=z3*cry-xa*sry;<br>    x3=z3*sry+xa*cry; y3=ya*crx-za*srx; z3=ya*srx+za*crx;<br>012 xc=(x1+x2+x3)/3; yc=(y1+y2+y3)/3; zc=(z1+z2+z3)/3;<br>013 za=fov/(z1*fov2-dist); z2=fov/(z2*fov2-dist); z3=fov/(z3*fov2-dist);<br>014 z1=400+z1+z2+z3; x1=x1*za; y1=y1*za; x2=x2*z2; y2=y2*z2; x3=x3*z3; y3=y3*z3;<br>015 nx=band(equal(y1,y2),equal(y2,y3));<br>016 ny=band(equal(z1,z2),equal(z2,z3));<br>017 nz=band(equal(x1,x2),equal(x2,x3));<br>018 //rotating normals (i'm not sure if the above method is good i'm a dumb in math<br>      (especially in calculating normals so i again told the values one-by-one))<br>019 xa=nx*crz-ny*srz; ya=nx*srz+ny*crz; za=nz*cry-xa*sry;<br>    nx=nz*sry+xa*cry; ny=ya*crx-za*srx; nz=ya*srx+za*crx;<br>020 norm=invsqrt(sqr(xc)+sqr(yc)+sqr(zc));<br>021 xc=-xc*norm; yc=-yc*norm; zc=-zc*norm;<br>022 dot=xc*nx+yc*ny+zc*nz;<br>023 rx=2*nx-xc; ry=2*ny-yc; rz=2*nz-zc;<br>024 spec=xc*rx+yc*ry+zc*rz;<br>025 skip=below(dot,0);<br>026 dr=.7; dg=.7; db=.7;<br>027 dot=1*max(dot,0);<br>028 spec=1*pow(max(spec,0),32);<br>029 red1=dr*dot+spec; blue1=db*dot+spec; green1=dg*dot+spec;<br>030 trc=trc+1; sw=bnot(sw);<br>end<br></code>
</pre><br>
      so i say big thanks to anybody who can help and i hope it's in the right place in the right form:confused:
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
    </div>
  </div>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" defer></script>
  <script type="text/javascript" src="../js/jquery.cookie.min.js" defer></script>
  <script type="text/javascript" src="../js/scripts.js" defer></script></body></html>