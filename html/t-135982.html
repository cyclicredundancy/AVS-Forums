<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Custom Blending Mode!" />

  <title>Custom Blending Mode! - AVS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body style="display:none">
  <div class="container">
    <div class="row">
        <div class="dropdown pull-right">
          <button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            Change style
            <span class="caret"></span>
          </button>
          <ul id="css-select" class="dropdown-menu" role="menu">
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">Default</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation" class="dropdown-header">Bootswatch</li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/amelia/bootstrap.min.css">Amelia</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cerulean/bootstrap.min.css">Cerulean</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cosmo/bootstrap.min.css">Cosmo</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cyborg/bootstrap.min.css">Cyborg</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/flatly/bootstrap.min.css">Flatly</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/journal/bootstrap.min.css">Journal</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css">Readable</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/simplex/bootstrap.min.css">Simplex</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/slate/bootstrap.min.css">Slate</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/spacelab/bootstrap.min.css">Spacelab</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/united/bootstrap.min.css">United</a></li>
            <li><a href="#" rel="//netdna.bootstrapcdn.com/bootswatch/3.0.2/yeti/bootstrap.min.css">Yeti</a></li>
          </ul>
        </div>
    </div>

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-138.html">AVS Wishlist</a></li>

      <li class="active">Custom Blending Mode!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=135982">Custom Blending Mode!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">20th May 2003 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"><strong>Custom Blending Mode!</strong><br />
      There should be a scriptable custom Blending mode where you could define the Blending yourselfes.<br />
      <br />
      I would like to see this basically within the effect list (input &amp; output) but everything else like buffers would be appreciated.<br />
      <br />
      How should it work?<br />
      <br />
      The layout &amp; functions of the DM / SSC should do it, we only need 6 new vars:<br />
      -source#red<br />
      -source#blue<br />
      -source#green<br />
      -destination#red<br />
      -destination#blue<br />
      -destination#green<br />
      <br />
      This way you can get the color values of the source frame as well as frame you want it to blend to, in coaxial or radial coordinates, as you like.<br />
      <br />
      What can we do with it? Something like UnConeDs Channelshifter APE would be quite easy and as we can add loads of code hyperweird color effects would be possible, even better ones as within an dyn color movement.<br />
      <br />
      *droooooooooool* :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shreyas_potnis</span><br /></p>

      <p class="post-time small text-muted">20th May 2003 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">forget it...winamp wont do it. i lost all hopes now. UnConeD has retired and no one else has such abilities. :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br /></p>

      <p class="post-time small text-muted">20th May 2003 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">and it's already been suggested several times.<br />
      and i'm not even sure if it's such a good idea in the first place. ask yourself, what would you actually make with this? :igor:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">20th May 2003 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">You do realize this would slow a preset to a crawl, right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zevensoft</span><br /></p>

      <p class="post-time small text-muted">21st May 2003 07:24 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">I see what he means, and no it's not as slow or bad as people think. It works like this...<br />
      <br />
      The old formula: dst = src*alpha + dst*(1-alpha) for each component.<br />
      <br />
      What he's suggesting: dst = src*alpha1 + dst*alpha2 + alpha3 for each component.<br />
      <br />
      Basically, instead of just specifying alpha in a DM, you can specify alpha1 = 1 and alpha2 = 1 for additive, alpha1 = .5 and alpha2 = 1-alpha3 for 50/50 blend (original style), or even alpha1 = -1 and alpha2 = 1 for subtractive. Just imagine the weird effects possibly by playing around with alpha1, alpha2, and alpha3 (the bias).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zevensoft</span><br /></p>

      <p class="post-time small text-muted">21st May 2003 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">And yes, having r_alphax, g_alphax, and b_alphax wouldn't slow it down, since it recalcs the blend code for each component anyway.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">21st May 2003 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">In fact i mean<br />
      <br />
      The RGB source values (the frame you're blending form, the just calculated one):<br />
      alpha_r_s<br />
      alpha_b_s<br />
      alpha_g_s<br />
      <br />
      And the RGB destination values (the frame you're blending to):<br />
      <br />
      alpha_r_d<br />
      alpha_b_d<br />
      alpha_g_d<br />
      <br />
      Only little changes with awesome possibillities.<br />
      <br />
      [Edit] Atero, i WOULD make some great color movements. Doing something like a channelshifter including blending between modes would be some of the easiest thing s you coud do. It would be a new way to <b>render</b> objects, as you can define colors now. It would be f**king great!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">21st May 2003 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Okay now I just don't get it. How would you do a channelshifter with this setup? You'd need a 3x3 matrix of coefficients for both source and destination... otherwise there is no way to swap information between channels.<br />
      <br />
      Though you have to remember that the whole blending pixels thing is done through very fast MMX assembly code. AVS doesn't split the channels into separate components, it works with all 3 at once.<br />
      <br />
      The alpha_r_s/d, alpha_g_s/d, alpha_b_s/d thing would only work with positive alpha's in the range 0..1 with the exception that one of the two sets can be completely negative.<br />
      <br />
      This is how alpha blending is done:<br />
      * 32-bit pixel 00R1G1B1 is mmx-unpacked into 0000_00R1_00G1_00B1<br />
      * 32-bit pixel 00R2G2B2 is mmx-unpacked into 0000_00R2_00G2_00B2<br />
      * pixel 1 is multiplied by 0000_00S1_00S1_00S1, where S1 is its alpha value * 256 (_ = separator, the whole is a 64-bit number).<br />
      * pixel 2 is multiplied by 0000_00S2_00S2_00S2 where S2 = (256 - S1)<br />
      <br />
      After multiplication, the two pixels are added together, so each channel will contain a value between 0 and 65536 (2^16). Then the lower bytes are discarded and the result is packed back into a 32-bit color.<br />
      <br />
      This means that (alpha1+alpha2) always has to be 0..1 (and both alpha1 and alpha2 separately separately as well). Otherwise after multiplication and addition, the channels will not fit into 16-bits and overflow occurs.<br />
      This is also what happens with convolution.ape when the sum of all values in the matrix is &gt; 256.<br />
      <br />
      Negative alpha values could be allowed for one of the two, by simply subtracting the colors instead of adding them.<br />
      <br />
      Instead of one alpha value, you could allow several alpha values so that instead of 0000_00S1_00S1_00S1 you multiply by 0000_00A1_00B1_00C1 (3 separate alpha values).<br />
      <br />
      The only thing you could do is NOT use MMX, but then it would indeed be ultra-slow.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zevensoft</span><br /></p>

      <p class="post-time small text-muted">21st May 2003 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Damnit, and I here I am thinkin MMX was high and mighty. At least you explained it in terms I could understand, no DUnCe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">22nd May 2003 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">UnConeD, this is fore sure nothing for an selfmade APE, this would be a supercomplex high end plugin - which in fact could only be made by the nullsoft guys.<br />
      <br />
      To answer the MMX Question: do you think DM works without MMX? Nope. So this is possible too with seperated color channels.<br />
      <br />
      How can i do Channelshifting? Simple we switch on beat between 6 modes<br />
      <br />
      This is an example for mode 1 (RGB -&gt; BRG):<br />
      col_r_d=col_b_s<br />
      col_g_d=col_r_s<br />
      col_b_d=col_g_s<br />
      <br />
      This is an example for 50/50 blending:<br />
      col_r_d=(col_r_d)/2+(col_r_s)/2;<br />
      col_g_d=(col_g_d)/2+(col_g_s)/2;<br />
      col_b_d=(col_b_d)/2+(col_b_s)/2;<br />
      <br />
      This shows how we do 50/50 on red channel, max blending on green channel and source red -&gt; destination blue channelshifting at once:<br />
      col_r_d=(col_r_d)/2+(col_r_s)/2;<br />
      col_g_d=max(col_g_d,col_g_s);<br />
      col_b_d=col_r_s;<br />
      <br />
      Understood now what i meant? (Sorry for the confusing expression "alpha" in my last post "COLOR" describes best what i mean)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">22nd May 2003 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Magic.X: what you're describing would be ULTRA slow. Trust me, even Nullsoft couldn't speed that up.<br />
      <br />
      Compare it to a superscope with n=320*240=76800.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shreyas_potnis</span><br /></p>

      <p class="post-time small text-muted">22nd May 2003 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Magix, UnconeD told me this before, you will have to split RGB values of the color, then do all the alpha-blending stuff, then convert this back to color. I have played around all this stuff when I was making Dynamic Clear Screen and now understand parts of it.<br />
      <br />
      btw. This will have to be so many times!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br /></p>

      <p class="post-time small text-muted">22nd May 2003 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">unconed - i think magic is suggesting this would work the same way as dm, with a much smaller amounts of calculations per frame (say 28x24x3=2016). this would still be far too slow though...equivalent to three seperate complex dynamovs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">23rd May 2003 02:56 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Err atero, the formulas HAVE to be evaluated per pixel. No way around that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br /></p>

      <p class="post-time small text-muted">23rd May 2003 03:01 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">...how come...?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">23rd May 2003 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Anyway, i think debating about "possible", "impossible" or "possible but überslow" aint the right way.<br />
      <br />
      Most of you will agree thast this effect would kick ass, so why don't put it into the whishlist???<br />
      <br />
      Besides, by now there are more powerfull optimized programming methods out there than MMX. There gotta be a way to do this, or how do modern Animation or Photoediting progs handle their work?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">23rd May 2003 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Magic.X: easy, they don't work real-time :P.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sidd</span><br /></p>

      <p class="post-time small text-muted">24th May 2003 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">so if that idea would be so slow, how come your channel shifter aint?<br />
      Im pressuming that you cant use mmx at all for that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">25th May 2003 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Because channel shifter just switches the channels around without doing any processing on them.<br />
      <br />
      Here are the instructions I use to process one pixel in the eax register.<br />
      <br />
      e.g.<br />
      RBG:<br />
      xchg ah, al;<br />
      <br />
      BRG:<br />
      mov dl, al;<br />
      shr eax, 8;<br />
      bswap eax;<br />
      mov ah, dl;<br />
      bswap eax;<br />
      <br />
      BGR:<br />
      bswap eax;<br />
      shr eax, 8;<br />
      <br />
      GBR:<br />
      mov edx, eax;<br />
      bswap edx;<br />
      shl eax, 8;<br />
      mov al, dh;<br />
      <br />
      GRB:<br />
      shl eax, 8;<br />
      bswap eax;<br />
      xchg ah, al;<br />
      bswap eax;<br />
      shr eax, 8;<br />
      <br />
      <br />
      As you can see, the amount of instructions depends on the mode, because of the way an x86 processor is layed out.<br />
      Doing a custom blend mode would require at least 40-50 lines of assembly code per pixel and that would be in the case of optimized compiled assembly. In reality, the code you type yourself would be executed slowly and inefficiently because writing a decent, optimizing compiler is waaay out of the scope of this project.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shreyas_potnis</span><br /></p>

      <p class="post-time small text-muted">26th May 2003 09:54 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Simple and fast rgb swaping example is given with Render / Picture II source :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">26th May 2003 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by UnConeD</i><br />
        <b>Magic.X: easy, they don't work real-time :P.</b>
      </blockquote>My Photoediting prog gives me a realtime preview (fullsized) so i can adjust the effect and add it if i'm done. Whats the Diffrence now?<br />
      <br />
      This effect is just the same as a blend only DM - perpixel manipulation. If you like we could specify a rastersize (just as the DM has) to save some rendering power.<br />
      <br />
      Anyway, we shouldnt drop the idea just because we think its impossible. This is a WHISHlist not a READYSOLUTIONSlist ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sidd</span><br /></p>

      <p class="post-time small text-muted">26th May 2003 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">MagicX, good point.. but if you use a grid, like the dm's, how do you calculate inbetween pixels? Bilinear wont work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnConeD</span><br /></p>

      <p class="post-time small text-muted">26th May 2003 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Eh?<br />
      MagicX... AVS has to render at 20-30 FPS. That means maximum 50 ms to do this effect, and that's for a preset including ONLY this effect.<br />
      A much more realistic target would be 5-10ms or less.<br />
      <br />
      Your photoshop might look 'realtime', but it probably has a latency of about 300-400ms.<br />
      <br />
      Anyway I'm tired of discussing this. If you're so convinced it IS possible, then by all means, pick up a C++/ASM book and start coding!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">27th May 2003 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">:hang: This is so depressing...!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jonasc1</span><br /></p>

      <p class="post-time small text-muted">20th June 2003 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Maybe if it was a plugin like an Ape with a extra blend mode. some APE's have blend modes. so since it works in an ape so why should it not work alone in a way the AVS understand it. So wath im sayin is not a scriptable blend mode system but as an plugin writen in some computer language like APE's.<br />
      Did anyone get it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mikm</span><br /></p>

      <p class="post-time small text-muted">20th June 2003 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">don't revive threads, god damn it!!!<br />
      <br />
      Anyways, if we wanted to access buffers, an APE could not handle that. APEs are .dll's and are written in c++<br />
      <br />
      <br />
      and please read the rest of the thread. I think you do not understand what you or anybody else is saying.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shreyas_potnis</span><br /></p>

      <p class="post-time small text-muted">21st June 2003 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">jonasc1, did you read the previous stuff?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Magic.X</span><br /></p>

      <p class="post-time small text-muted">23rd June 2003 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></p>

      <p class="post-content">Unlikely, or he did'nt understands it maybe this discussion got too technified.<br />
      <br />
      I recently downloaded the new Athlon 64 tech docs to see wheter there is a solution to this problem.<br />
      <br />
      With the lack of Buffer Access it could be done as an APE. The main question now is only the speed.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p>
    </div>
  </div><!-- Put JavaScript here -->
  <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="../js/jquery.cookie.min.js"></script>
  <script type="text/javascript" src="../js/scripts.js"></script>
</body>
</html>
