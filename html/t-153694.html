<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Is there an API for the AVS?"><title>Is there an API for the AVS? - AVS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-7','auto');ga('send','pageview');</script><link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"></head><body style="display:none"><div class="container"><div class="row"><div class="dropdown pull-right"><button class="btn btn-link btn-sm dropdown-toggle" type="button" data-toggle="dropdown">Change style <span class="caret"></span></button><ul id="css-select" class="dropdown-menu" role="menu"><li><a href="#" rel="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">Default</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Bootswatch</li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/amelia/bootstrap.min.css">Amelia</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css">Cerulean</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css">Cosmo</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cyborg/bootstrap.min.css">Cyborg</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css">Flatly</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css">Journal</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css">Readable</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css">Simplex</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/slate/bootstrap.min.css">Slate</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css">Spacelab</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css">United</a></li><li><a href="#" rel="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css">Yeti</a></li></ul></div></div><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-85.html">AVS</a></li><li class="active">Is there an API for the AVS?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153694">Is there an API for the AVS?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">toq3r</span><br></p><p class="post-time small text-muted">23rd October 2003 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"><strong>Is there an API for the AVS?</strong><br>Boy nothing like a fistfull of anger and a few 2litres of soda to get something accomplished :D<br><br>I've written a karaoke zip player for use with the CDG plugin by Yannick. <a href="http://www.bathroomsbyhans.com/karaokezipplayer.zip." target="_blank">http://www.bathroomsbyhans.com/karaokezipplayer.zip.</a> Eventually it's going to get better, as this is my first windows application of any kind outside of batch files and logon scripts.<br><br>I would like to set the AVS overlay color through some kind of API call or what not. Is there any way of doing this?<br><br>--toqer</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Magic.X</span><br></p><p class="post-time small text-muted">23rd October 2003 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Erm ... no. But wait ... no!<br><br>Unless you like to go through the extremely painfull way of analyzing handles and simulating user actions by the messaging system.<br><br>This is no easy job and if you're not used to Win32 programming, probably impossible. Took me 2 years to get things like this done.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">toq3r</span><br></p><p class="post-time small text-muted">23rd October 2003 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Dude, I got a handle on it, just give me the answer if you got it.<br><br>**edit**<br><br>Ohhhhh I see what you're saying. You did give me an answer. So there is no easy way to do this through the windows messaging API? Let me make sure I have this straight...<br><br>To the best of your knowledge, there's no windows message function I could use to set the overlay value.<br><br>You're suggesting that I simulate user input, so basically I would have to find the winamp parent window, find the AVS subwindow, simulate a dbl click on it, simulate a mouse click on settings from the file menu, simulate going to display, then simulate going to the overlay box, simulate a dbl click on the overlay box, then simulate it adding the RGB value to the custom color text box.<br><br>Did I miss anything? You're right, that's kludgy as hell, are you SURE there's no easier way of doing it through an API call?<br><br>PS nullsoft dev's please chirp in an answer if you can, I gave you atari stuff remember?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Magic.X</span><br></p><p class="post-time small text-muted">23rd October 2003 14:20 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">You got the point ;)<br><br>I managed to switch between transition modes remotely via hotlist and this needs to:<br>-get the editor window<br>-get the menu handle and find the proper menu<br>-execute the menu, so the config page will show up<br>-change the controls as i want<br>-send a friggin notification message (which was damn hard to spy out)<br><br>Your task is even more complex as you'll require to work with the selectcolor-popup window as well. Kludgy as hell, you named it.<br><br>Even more as the main menu got changed for version 2.7 so you'll need to make it backward compatible.<br><br>Good luck on this, don't know if it helps but i could give you some Delphi example code which i use for changing transition if you want. :)<br><br>Btw, the link in your first post does not work</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">UnConeD</span><br></p><p class="post-time small text-muted">23rd October 2003 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">I'm not sure what you need to do, but you can always read out the current overlay color from Winamp.ini, in the [AVS] section "cfg_bkgnd_render_color". It's a regular 32-bit integer either in 0RGB or 0BGR format (not sure which).<br><br>If AVS is not running, you can change the color by changing this value in the .ini.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Magic.X</span><br></p><p class="post-time small text-muted">23rd October 2003 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Hmm, i know that you could turn avs on and off for this via api calls, but i think this was only allowed to plugins. And if it works, turning avs off may cause undesired effects.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">toq3r</span><br></p><p class="post-time small text-muted">23rd October 2003 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content"></p><blockquote><i>Originally posted by UnConeD</i><br><b>I'm not sure what you need to do, but you can always read out the current overlay color from Winamp.ini, in the [AVS] section "cfg_bkgnd_render_color". It's a regular 32-bit integer either in 0RGB or 0BGR format (not sure which).<br></b></blockquote>YES!! That's damn close to what I need to do. Unfortunatly this method seems to want to want me to completely restart winamp in order for it to work...<br><br>Oh in case you're wondering "wtf is toq trying to accomplish" Well basically i'm working on a set of open sore(source) programs for karaoke hosters. Having AVS behind the lyrics in karaoke r0x. 2 more addons I want to do to my program this week is..<br><br>A quick way to switch the overlay color, maybe a set of radio buttons for each karaoke manufacturer.<br><br>Build a frontend to the imagemagick dll so I can create a "Next Singer" AvS that will basically be a render&gt;picture preset. Type in the singers name, it takes an input image, montages the singers name, and dumps it in the AVS folder.<br><br>Oh yah, for that link that doesn't work...<br><a href="http://www.bathroomsbyhans.com/karaokezipplayer.zip" target="_blank">http://www.bathroomsbyhans.com/karaokezipplayer.zip</a><br><br>Thanks again guys for giving me something to chew on. Now I have 2 ways to kludge this. Simulate user input, or write the value to winamp.ini and restart winamp. (I think I might try door#2 first)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Magic.X</span><br></p><p class="post-time small text-muted">24th October 2003 06:40 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Here is the code i use for transmitting transition settings.<br>Its the pure unchanged function i use, so there will be stuff in, which you won't need, but you should get the main idea i think. ;)<br><br><font face="courier new"><br>function SubmitSettings: Boolean;<br>var<br>h,h2,hm,hs,ht,hc :hwnd;<br>id :integer;<br>begin<br>h:=findwindow('#32770','Winamp AVS Editor - Hotlist Active');<br>if h=0 then<br>##begin<br>##h:=findwindow('#32770','Winamp AVS Editor');<br>##if h=0 then<br>####begin<br>####Result:=false;<br>####HotlistMain.setdelay:=true;<br>####end<br>##else<br>####begin<br>####Result:=true;<br>####HotlistMain.setdelay:=false;<br>####SetWindowText(h,'Winamp AVS Editor - Hotlist Active');<br>####end;<br>##end<br>else<br>##begin<br>##Result:=true;<br>##HotlistMain.setdelay:=false;<br>##h2:=findwindowex(h,0,'Button','Transitions');<br>##if h2=0 then<br>####begin<br>####hm:=getmenu(h);<br>####hs:=GetSubMenu(hm,1);<br>####if GetMenuItemCount(hs)=2 then hs:=GetSubMenu(hm,2);<br>####id:=GetMenuItemID(hs,4);<br>####SendMessage(h,WM_COMMAND,id,0);<br>####end;<br>##h2:=findwindowex(h,0,'#32770',nil);<br>##{Enable Transition}<br>##ht:=findwindowex(h2,0,nil,'Enable Transition on load preset');<br>##if HotlistMain.Trans.Checked<br>####then sendmessage(ht,BM_SetCheck,BST_CHECKED,0)<br>####else sendmessage(ht,BM_SetCheck,BST_UNCHECKED,0);<br>##sendmessage(h2,WM_Command,1117,ht);<br>##{Render Old effect}<br>##ht:=findwindowex(h2,0,nil,'Keep rendering old effect');<br>##if HotlistMain.RenderOld.Checked<br>####then sendmessage(ht,BM_SetCheck,BST_CHECKED,0)<br>####else sendmessage(ht,BM_SetCheck,BST_UNCHECKED,0);<br>##sendmessage(h2,WM_Command,1118,ht);<br>##{Transition}<br>##hc:=findwindowex(h2,0,'ComboBox',nil);<br>##sendmessage(hc,cb_setcursel,HotlistMain.ComboBox1.ItemIndex,0);<br>##sendmessage(h2,WM_Command,$0001043F,hc);<br>##{Speed}<br>##ht:=findwindowex(h2,0,nil,'Slider1');<br>##sendmessage(ht,TBM_SetPos,1,HotlistMain.TrackBar1.Position);<br>##sendmessage(h2,WM_Notify,$00000418,0);<br>##{FixOnTop}<br>##h:=findwindow('avswnd',nil);<br>##if h=0 then h:=findwindow('Winamp Gen','AVS');<br>##if HotlistMain.Fixontop.Checked then setwindowpos(h,hwnd_topmost,0,0,0,0,swp_nomove+swp_nosize+swp_noactivate)<br>##else setwindowpos(h,hwnd_notopmost,0,0,0,0,swp_nomove+swp_nosize+swp_noactivate);<br>##end;<br>end;<br></font><br><br>[edit] used # instead of spaces, because multi spaces won't show up i this forum.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">UnConeD</span><br></p><p class="post-time small text-muted">24th October 2003 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">In that case, why don't you just use AVS's color instead of trying to force your own?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">toq3r</span><br></p><p class="post-time small text-muted">25th October 2003 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Cause each karaoke manufacturer uses a different RGB value for their karaoke backgrounds.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">UnConeD</span><br></p><p class="post-time small text-muted">25th October 2003 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">Ah my bad, thought you were doing the karaoke software too.<br><br>Note that you don't need to restart winamp for modifying the ini, you can just restart AVS. The Winamp API is documented on the develop section of this site and shouldn't be a problem. Use the standard ini functions in windows and it should be a breeze.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">toq3r</span><br></p><p class="post-time small text-muted">26th October 2003 01:52 <abbr title="Coordinated Universal Time">UTC</abbr></p><p class="post-content">That's it? Damn, so easy.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/visbot/AVS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" defer></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" defer></script><script type="text/javascript" src="../js/jquery.cookie.min.js" defer></script><script type="text/javascript" src="../js/scripts.js" defer></script></body></html>